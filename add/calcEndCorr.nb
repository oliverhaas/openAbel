(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    231473,       5347]
NotebookOptionsPosition[    227731,       5211]
NotebookOutlinePosition[    228077,       5226]
CellTagsIndexPosition[    228034,       5223]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Abel Transform Quadrature Coefficients", "Title",
 CellChangeTimes->{{3.718616805843172*^9, 3.7186168248789062`*^9}, {
  3.720934019891317*^9, 3.7209340200081043`*^9}, {3.7213143167747917`*^9, 
  3.721314321535946*^9}}],

Cell["\<\
This is a script for the calculation of high-order end corrections for the \
Abel transform for uniform discretization.
This script is additional material to our Python implementation and \
publication (see http://www.github.com/oliverhaas/openAbel), where these \
coefficients are used in conjunction with the Fast Multipole Method to get a \
both fast converging and linear computational complexity algorithm of the \
numerical Abel Transform.

Some calculations actually take quite a while. In general I valued accuracy \
over run time to ensure double precision accuracy of the final results. There \
might be room for tweaks, but since the whole script runs over one night (and \
then I save the result and I never intent to use the script again, more or \
less) I think it\[CloseCurlyQuote]s not really necessary.
Evaluation times estimates are for 2018 middle of the pack workstations.\
\>", "Text",
 CellChangeTimes->{{3.71846937031215*^9, 3.7184693977478733`*^9}, {
   3.719907329525364*^9, 3.719907348294083*^9}, {3.7203543216609287`*^9, 
   3.720354406344445*^9}, {3.7207809019258337`*^9, 3.720781095268413*^9}, {
   3.720934020043079*^9, 3.7209340227857037`*^9}, 3.720935156268909*^9, {
   3.720935193828916*^9, 3.720935212979561*^9}, {3.746611532181793*^9, 
   3.7466116166289387`*^9}, {3.7467940949805393`*^9, 
   3.7467941444120865`*^9}, {3.74697344570164*^9, 3.746973627129376*^9}, {
   3.7472875599736443`*^9, 3.7472876118930387`*^9}}],

Cell[CellGroupData[{

Cell["Initialization", "Chapter",
 CellChangeTimes->{{3.746794085869082*^9, 3.7467940878203526`*^9}, {
  3.7467941579792624`*^9, 3.7467941624281683`*^9}, {3.7467950871577196`*^9, 
  3.746795095285771*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Just", " ", "set", " ", "the", " ", "directory", " ", "to", " ", "the", 
    " ", "notebook", " ", "directory", " ", "so", " ", "coefficients", " ", 
    "are", " ", "saved", " ", 
    RowBox[{"there", "."}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.746973631672824*^9, 3.746973671264349*^9}, {
  3.747287621473395*^9, 3.7472876261735177`*^9}}],

Cell[BoxData["\<\"D:\\\\HESSENBOX-DA\\\\PhD\\\\code\\\\openAbel\\\\add\"\>"], \
"Output",
 CellChangeTimes->{3.7472887420998077`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Kernels of type",
 Cell[BoxData[
  FormBox[
   FractionBox["1", 
    SqrtBox[
     RowBox[{"r", "-", "y"}]]], TraditionalForm]]]
}], "Chapter",
 CellChangeTimes->{{3.717427346214748*^9, 3.7174274183414197`*^9}, {
  3.7174284500469685`*^9, 3.7174284615245843`*^9}, {3.7177548919604816`*^9, 
  3.717754892985018*^9}, {3.719319573724607*^9, 3.719319579876113*^9}, {
  3.720934023122142*^9, 3.72093402315481*^9}, {3.7213144481549435`*^9, 
  3.7213144497219915`*^9}, {3.7469750454934473`*^9, 3.746975046310034*^9}}],

Cell["\<\
These here are used for the upper end of the integration interval of the Abel \
transform. In principle one could use just end corrections for smooth \
integrands, but treating the 1/Sqrt[r-y] part even when it\[CloseCurlyQuote]s \
not obviously close improves the error of the result at the right end of the \
interval quite a bit. End corrections for 1/Sqrt[r^2-y^2] are in principle \
possible as well, but they depend on too many variables (at least two of y, \
r-y or r+y) to store efficiently, at least as far as I understood.\
\>", "Text",
 CellChangeTimes->{{3.7469737402970743`*^9, 3.746973757565529*^9}, {
  3.7469750287011175`*^9, 3.7469750523159447`*^9}, {3.7469750828566556`*^9, 
  3.7469751058509846`*^9}, {3.7469751428415093`*^9, 3.7469752846865005`*^9}, {
  3.74728763522897*^9, 3.747287875828151*^9}, {3.7472879345706587`*^9, 
  3.747287963890277*^9}}],

Cell[CellGroupData[{

Cell["Non-singular end", "Subchapter",
 CellChangeTimes->{
  3.71742844309836*^9, {3.7177453013007812`*^9, 3.717745303081952*^9}, 
   3.718366861491877*^9, {3.7209340233519077`*^9, 3.720934023394415*^9}, {
   3.721314891672616*^9, 3.7213148945675354`*^9}}],

Cell[CellGroupData[{

Cell["Small intervals", "Section",
 CellChangeTimes->{{3.718364711262013*^9, 3.718364713862175*^9}, 
   3.720934023435107*^9, {3.721323823998592*^9, 3.7213238241156716`*^9}}],

Cell["Typical evaluation time: Minutes", "Text",
 CellChangeTimes->{{3.71784314003749*^9, 3.71784314617327*^9}, {
  3.71800774651274*^9, 3.718007747280629*^9}, {3.720934023523591*^9, 
  3.720934023646649*^9}, {3.720935237105504*^9, 3.720935237923073*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kmax", "=", "19"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prec", "=", "80"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xmax", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nCross", "=", "128"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nTable", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"ii", ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "2", ",", "nCross"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"err", "=", 
    RowBox[{"10", "^", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "prec"}], "/", "2"}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"kInner", "=", 
       RowBox[{"Floor", "[", 
        RowBox[{"k", "/", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"kOuter", "=", 
       RowBox[{"Floor", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k", "-", "1"}], ")"}], "/", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"fun", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"x", "-", "xmax"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"ii", "-", "1"}], ")"}]}], "/", 
            RowBox[{"Sqrt", "[", "x", "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"funNoSing", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"x", "-", "xmax"}], ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"ii", "-", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"n", "=", 
           RowBox[{"nTable", "[", 
            RowBox[{"[", "mm", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"h", "=", 
           RowBox[{"xmax", "/", 
            RowBox[{"(", 
             RowBox[{"n", "-", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"intervals", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"jj", "-", "1"}], ")"}], ",", 
             RowBox[{"{", 
              RowBox[{"jj", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"integ", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"h", "*", 
              RowBox[{"NIntegrate", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"fun", "/.", 
                   RowBox[{"x", "\[Rule]", 
                    RowBox[{"xInd", "*", "h"}]}]}], ")"}], "-", 
                 RowBox[{"(", 
                  RowBox[{"fun", "/.", 
                   RowBox[{"(", 
                    RowBox[{"x", "\[Rule]", 
                    RowBox[{
                    RowBox[{"Ceiling", "[", "xInd", "]"}], "*", "h"}]}], 
                    ")"}]}], ")"}]}], ",", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"{", "xInd", "}"}], ",", "intervals"}], "]"}], ",", 
                
                RowBox[{"PrecisionGoal", "\[Rule]", 
                 RowBox[{"prec", "/", "2"}]}], ",", 
                RowBox[{"WorkingPrecision", "\[Rule]", "prec"}], ",", 
                RowBox[{"MaxRecursion", "\[Rule]", "50"}], ",", 
                RowBox[{"Method", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"Automatic", ",", 
                   RowBox[{"\"\<SymbolicProcessing\>\"", "\[Rule]", "0"}]}], 
                  "}"}]}]}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"ii", ",", "1", ",", "k"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"b", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Total", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"1", "/", "h"}], "*", 
                   RowBox[{"integ", "[", 
                    RowBox[{"[", "ii", "]"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"+", "1"}], "/", "2"}], "*", "fun"}], "/.", 
                   RowBox[{"x", "\[Rule]", "xmax"}]}], ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{"funNoSing", ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "ss"}], "}"}]}], "]"}], "*", 
                    RowBox[{"Zeta", "[", 
                    RowBox[{
                    RowBox[{"1", "/", "2"}], "-", "ss"}], "]"}], "*", 
                    RowBox[{
                    RowBox[{"h", "^", 
                    RowBox[{"(", 
                    RowBox[{"ss", "-", 
                    RowBox[{"1", "/", "2"}]}], ")"}]}], "/", 
                    RowBox[{"Factorial", "[", "ss", "]"}]}]}], "/.", 
                    RowBox[{"x", "\[Rule]", "0"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"ss", ",", "0", ",", 
                    RowBox[{"ii", "-", "1"}]}], "}"}]}], "]"}]}], "}"}], "//",
                 "Flatten"}], ",", 
               RowBox[{
               "Method", "\[Rule]", "\"\<CompensatedSummation\>\""}]}], "]"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"ii", ",", "1", ",", "k"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"A", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"funNoSing", "/.", 
              RowBox[{"x", "\[Rule]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"n", "-", "1"}], ")"}], "+", "jj"}], ")"}], "*", 
                "h"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"ii", ",", "1", ",", "k"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"jj", ",", 
               RowBox[{"-", "kInner"}], ",", "kOuter"}], "}"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{"LinearSolve", "[", 
             RowBox[{"A", ",", "b"}], "]"}], "*", 
            RowBox[{"Sqrt", "[", "xmax", "]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"mm", ",", "1", ",", 
           RowBox[{"Length", "[", "nTable", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"Chop", "[", 
        RowBox[{"res", ",", "err"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"StringJoin", "[", 
         RowBox[{"\"\<coeffs_invSqrt_nonsing_small_\>\"", ",", 
          RowBox[{"IntegerString", "[", 
           RowBox[{"k", ",", "10", ",", "2"}], "]"}], ",", "\"\<.h5\>\""}], 
         "]"}], ",", "res"}], "]"}]}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "kmax", ",", "1"}], "}"}]}], "]"}], ";"}], "//",
   "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.715534951620734*^9, 3.7155349525304127`*^9}, {
   3.715534983960764*^9, 3.715534985711547*^9}, {3.715535693309306*^9, 
   3.715535701187627*^9}, {3.715535907337347*^9, 3.71553592867807*^9}, {
   3.7155359861384497`*^9, 3.715535998522759*^9}, {3.715536034601077*^9, 
   3.715536053863694*^9}, {3.7155395112333603`*^9, 3.7155395115918293`*^9}, {
   3.715577598094926*^9, 3.715577600300043*^9}, {3.7155776430191803`*^9, 
   3.7155776524496527`*^9}, {3.715578014862153*^9, 3.715578136097129*^9}, {
   3.715578168738401*^9, 3.715578212054441*^9}, {3.7155784196135883`*^9, 
   3.715578489848918*^9}, {3.715578534272182*^9, 3.715578567785666*^9}, {
   3.7155786911947536`*^9, 3.715578699262437*^9}, 3.715578797262356*^9, {
   3.7155790747113657`*^9, 3.7155790852067013`*^9}, {3.715579140074526*^9, 
   3.7155791417287703`*^9}, {3.715579185797657*^9, 3.715579200871029*^9}, {
   3.7155801194740067`*^9, 3.715580123513418*^9}, {3.7155846434192457`*^9, 
   3.7155846546263638`*^9}, {3.7174275158020444`*^9, 3.717427516366419*^9}, {
   3.7174275615343733`*^9, 3.7174275616544504`*^9}, {3.717843001057715*^9, 
   3.7178430739014387`*^9}, {3.7178431100551863`*^9, 
   3.7178431264077272`*^9}, {3.718007449847979*^9, 3.718007470556767*^9}, {
   3.718007637704866*^9, 3.718007637821612*^9}, {3.7180077075718403`*^9, 
   3.7180077087393827`*^9}, {3.718007788720484*^9, 3.7180078151660147`*^9}, {
   3.718007873585425*^9, 3.71800793000704*^9}, {3.7180080919048157`*^9, 
   3.718008102119597*^9}, {3.7180083184472837`*^9, 3.718008330836564*^9}, {
   3.718008371345456*^9, 3.718008380280656*^9}, {3.7180084111295958`*^9, 
   3.718008435906206*^9}, {3.7180093077509604`*^9, 3.718009326671731*^9}, {
   3.7180095904314203`*^9, 3.718009600279806*^9}, {3.718016749762879*^9, 
   3.718016751900963*^9}, {3.7180183438266687`*^9, 3.718018365618169*^9}, {
   3.718018851845334*^9, 3.718018882069796*^9}, {3.718018925224133*^9, 
   3.7180190129849052`*^9}, {3.718019169774755*^9, 3.718019169899654*^9}, 
   3.7180236521984243`*^9, {3.718465714857778*^9, 3.71846571574837*^9}, {
   3.718465757829273*^9, 3.718465757992382*^9}, {3.7184660781146593`*^9, 
   3.7184661066405754`*^9}, {3.718470842075247*^9, 3.718470842302444*^9}, {
   3.718470874768346*^9, 3.718470877038159*^9}, {3.7186200756794024`*^9, 
   3.718620091287311*^9}, {3.7186201434976387`*^9, 3.718620171888906*^9}, {
   3.718620251643642*^9, 3.718620253230589*^9}, {3.718623105979373*^9, 
   3.718623106079954*^9}, 3.7186231360946293`*^9, {3.718699624157955*^9, 
   3.718699624352512*^9}, {3.719233547603689*^9, 3.7192335546999702`*^9}, {
   3.7199071801633663`*^9, 3.719907180332315*^9}, {3.720439992949479*^9, 
   3.72043999313199*^9}, {3.720708088253187*^9, 3.720708093636836*^9}, {
   3.720708460590014*^9, 3.720708480416114*^9}, {3.7207087020048227`*^9, 
   3.720708703473641*^9}, 3.7207087355224657`*^9, {3.72070879110076*^9, 
   3.7207087989064283`*^9}, {3.720708857444255*^9, 3.720708889069665*^9}, {
   3.720708941996353*^9, 3.720708964324019*^9}, {3.720709063769051*^9, 
   3.720709064991033*^9}, {3.7207794292422867`*^9, 3.720779430026657*^9}, {
   3.720880130021221*^9, 3.720880130225274*^9}, 3.7210228096938066`*^9, {
   3.721314899250641*^9, 3.721314899381728*^9}, {3.721314944290521*^9, 
   3.721314961605007*^9}, {3.721315023511076*^9, 3.7213150847266865`*^9}, {
   3.721315122209553*^9, 3.7213151283726406`*^9}, {3.721315206446439*^9, 
   3.7213152152222576`*^9}, 3.721315273888177*^9, {3.7213153191672153`*^9, 
   3.721315364814498*^9}, 3.7213155011459394`*^9, {3.721315536623475*^9, 
   3.7213155433489375`*^9}, {3.7213156533956776`*^9, 3.721315724478485*^9}, {
   3.721315758383978*^9, 3.721315761712186*^9}, {3.721324635278549*^9, 
   3.7213246483982315`*^9}, {3.721326255182129*^9, 3.7213262749252214`*^9}, {
   3.7213735358487005`*^9, 3.721373649407983*^9}, {3.721373687400174*^9, 
   3.7213737695856524`*^9}, {3.7213738122619505`*^9, 
   3.7213738124050436`*^9}, {3.7213738428312163`*^9, 3.72137384949163*^9}, {
   3.7213739413735433`*^9, 3.7213739579725475`*^9}, {3.721374138126688*^9, 
   3.7213741413638377`*^9}, {3.7213741841562057`*^9, 3.721374311355531*^9}, {
   3.721374401916567*^9, 3.721374449789297*^9}, {3.7213745360959034`*^9, 
   3.721374538832718*^9}, 3.72137564135611*^9, {3.7213756922689323`*^9, 
   3.721375714288641*^9}, {3.7465919231752205`*^9, 3.7465919233127947`*^9}, {
   3.7465931188605933`*^9, 3.746593123870495*^9}, 3.7465985152566223`*^9, 
   3.7466315192805405`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1390.6454982616842`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.718023666032325*^9, 3.718466637344494*^9, 3.718470913615587*^9, 
   3.718515980113626*^9, 3.718620155482313*^9, 3.718620253723724*^9, 
   3.718620286768736*^9, {3.718623132148717*^9, 3.718623157793026*^9}, 
   3.7186232545794992`*^9, 3.718699350824396*^9, 3.718699685402697*^9, 
   3.719907248878829*^9, 3.720440188613456*^9, 3.720710087356945*^9, 
   3.720783459456044*^9, 3.720881490584303*^9, 3.721315225734231*^9, 
   3.7213152809958963`*^9, {3.721315320251933*^9, 3.7213153688191547`*^9}, {
   3.721315701117989*^9, 3.721315711131633*^9}, 3.7213157643889623`*^9, 
   3.7213250745161867`*^9, 3.7213315166180983`*^9, {3.721373771998251*^9, 
   3.7213737899091263`*^9}, {3.721373827993373*^9, 3.7213738470169845`*^9}, 
   3.7213739214753447`*^9, 3.7213739592303815`*^9, 3.721374144865159*^9, 
   3.721374187205223*^9, 3.72137428413548*^9, 3.7213743142494497`*^9, {
   3.7213744086860523`*^9, 3.7213744329491405`*^9}, 3.721374488485334*^9, 
   3.721375589726413*^9, 3.721375636002647*^9, 3.721375688812847*^9, 
   3.721376203620419*^9, 3.7466000412772837`*^9, 3.7472901329640846`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Large Intervals", "Section",
 CellChangeTimes->{{3.718364686285799*^9, 3.718364690734623*^9}, 
   3.720934023668146*^9, {3.7213153778681574`*^9, 3.7213153779442077`*^9}}],

Cell["Typical evaluation time: Minutes", "Text",
 CellChangeTimes->{
  3.717843163926485*^9, {3.718364644893166*^9, 3.718364679301764*^9}, {
   3.7209340237844877`*^9, 3.72093402392478*^9}, {3.720935246450189*^9, 
   3.720935247249529*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kmax", "=", "19"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prec", "=", "80"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xmax", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ordAna", "=", "50"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"err", "=", 
   RowBox[{"10", "^", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "prec"}], "/", "2"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nCross", "=", "128"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nInvCount", "=", "256"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nInvTable", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Range", "[", "nInvCount", "]"}], "/", "nInvCount"}], "/", 
    RowBox[{"(", 
     RowBox[{"nCross", "-", "1"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nTable", "=", 
    RowBox[{
     RowBox[{"1", "/", "nInvTable"}], "+", "1"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"kInner", "=", 
       RowBox[{"Floor", "[", 
        RowBox[{"k", "/", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"kOuter", "=", 
       RowBox[{"Floor", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k", "-", "1"}], ")"}], "/", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"10", "^", "3"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"h", "=", 
       RowBox[{"xmax", "/", 
        RowBox[{"(", 
         RowBox[{"n", "-", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"funNoSing", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x", "-", "xmax"}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"ii", "-", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"-", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{"funNoSing", ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{
                    RowBox[{"2", "*", "ss"}], "-", "1"}]}], "}"}]}], "]"}], 
                  "*", 
                  RowBox[{"h", "^", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "ss"}], "-", "1"}], ")"}]}], "*", 
                  RowBox[{
                   RowBox[{"BernoulliB", "[", 
                    RowBox[{"2", "*", "ss"}], "]"}], "/", 
                   RowBox[{"Factorial", "[", 
                    RowBox[{"2", "*", "ss"}], "]"}]}]}], "/.", 
                 RowBox[{"x", "\[Rule]", "xmax"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"ss", ",", "1", ",", 
                  RowBox[{"ii", "-", "1"}]}], "}"}]}], "]"}], "}"}], "//", 
             "Flatten"}], ",", 
            RowBox[{"Method", "\[Rule]", "\"\<CompensatedSummation\>\""}]}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", "k"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"A", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"funNoSing", "/.", 
          RowBox[{"x", "\[Rule]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"n", "-", "1"}], ")"}], "+", "jj"}], ")"}], "*", 
            "h"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "2", ",", "k"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", 
           RowBox[{"-", "kInner"}], ",", "kOuter"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"A", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{"N", "[", 
             RowBox[{"1", ",", "prec"}], "]"}], ",", "k"}], "]"}], "}"}], ",",
          "A"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nuAsympt", "=", 
       RowBox[{"N", "[", 
        RowBox[{"LinearSolve", "[", 
         RowBox[{"A", ",", "b"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"n", "=", 
           RowBox[{"nTable", "[", 
            RowBox[{"[", "mm", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"h", "=", 
           RowBox[{"xmax", "/", 
            RowBox[{"(", 
             RowBox[{"n", "-", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"xext", "=", 
           RowBox[{"xmax", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"next", "-", "1"}], ")"}], "*", "h"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"fun", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"x", "-", "xmax"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"ii", "-", "1"}], ")"}]}], "/", 
            RowBox[{"Sqrt", "[", "x", "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"funNoSing", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"x", "-", "xmax"}], ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"ii", "-", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"b", "=", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"arr", "=", 
               RowBox[{"ConstantArray", "[", 
                RowBox[{
                 RowBox[{"N", "[", 
                  RowBox[{"0", ",", "prec"}], "]"}], ",", "ordAna"}], "]"}]}],
               ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"arr", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{"fun", ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "1"}], "}"}]}], "]"}], "*", "h", "*", 
                  RowBox[{
                   RowBox[{"BernoulliB", "[", "2", "]"}], "/", 
                   RowBox[{"Factorial", "[", "2", "]"}]}]}], ")"}], "/.", 
                RowBox[{"x", "\[Rule]", "xmax"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"ll", "=", "2"}], ",", 
                RowBox[{"ll", "\[LessEqual]", "ordAna"}], ",", 
                RowBox[{"ll", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"arr", "[", 
                   RowBox[{"[", "ll", "]"}], "]"}], "=", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{"fun", ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{
                    RowBox[{"2", "*", "ll"}], "-", "1"}]}], "}"}]}], "]"}], 
                    "*", 
                    RowBox[{"h", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "ll"}], "-", "1"}], ")"}]}], "*", 
                    RowBox[{
                    RowBox[{"BernoulliB", "[", 
                    RowBox[{"2", "*", "ll"}], "]"}], "/", 
                    RowBox[{"Factorial", "[", 
                    RowBox[{"2", "*", "ll"}], "]"}]}]}], "/.", 
                   RowBox[{"x", "\[Rule]", "xmax"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"sum", "=", 
                  RowBox[{"Total", "[", 
                   RowBox[{
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", "ll"}], "]"}], "]"}], ",", 
                    RowBox[{
                    "Method", "\[Rule]", "\"\<CompensatedSummation\>\""}]}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"ll", ">", 
                    RowBox[{"Floor", "[", 
                    RowBox[{"2", "+", 
                    RowBox[{"ii", "/", "2"}]}], "]"}]}], "&&", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"arr", "[", 
                    RowBox[{"[", "ll", "]"}], "]"}], "]"}], "<=", 
                    RowBox[{"err", "*", 
                    RowBox[{"Abs", "[", "sum", "]"}]}]}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Break", "[", "]"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ll", "\[GreaterEqual]", "ordAna"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "Print", "[", 
                    "\"\<Euler-Mclaurin series possibly not converged.\>\"", 
                    "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"-", "sum"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"ii", ",", "1", ",", "k"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"A", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"funNoSing", "/.", 
              RowBox[{"x", "\[Rule]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"n", "-", "1"}], ")"}], "+", "jj"}], ")"}], "*", 
                "h"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"ii", ",", "2", ",", "k"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"jj", ",", 
               RowBox[{"-", "kInner"}], ",", "kOuter"}], "}"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"A", "=", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{
                RowBox[{"N", "[", 
                 RowBox[{"1", ",", "prec"}], "]"}], ",", "k"}], "]"}], "}"}], 
             ",", "A"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{"LinearSolve", "[", 
             RowBox[{"A", ",", "b"}], "]"}], "*", 
            RowBox[{"Sqrt", "[", "xmax", "]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"mm", ",", "1", ",", 
           RowBox[{"Length", "[", "nTable", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "nuAsympt", "}"}], ",", "res"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"Chop", "[", 
        RowBox[{"res", ",", "err"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"StringJoin", "[", 
         RowBox[{"\"\<coeffs_invSqrt_nonsing_large_\>\"", ",", 
          RowBox[{"IntegerString", "[", 
           RowBox[{"k", ",", "10", ",", "2"}], "]"}], ",", "\"\<.h5\>\""}], 
         "]"}], ",", "res"}], "]"}]}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "kmax", ",", "1"}], "}"}]}], "]"}], ";"}], "//",
   "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.7155385081470623`*^9, 3.715538542513125*^9}, {
   3.7155385794420567`*^9, 3.715538591702312*^9}, {3.715538631890684*^9, 
   3.715538639834957*^9}, {3.715538676425861*^9, 3.7155386766408587`*^9}, {
   3.7155388270948772`*^9, 3.7155388515125513`*^9}, {3.715538894818214*^9, 
   3.7155388952145977`*^9}, {3.7155390234745293`*^9, 3.7155390761075*^9}, {
   3.715539118587027*^9, 3.71553911880893*^9}, {3.715539165294754*^9, 
   3.715539197045686*^9}, {3.7155392547583513`*^9, 3.71553926108309*^9}, {
   3.715539291417594*^9, 3.7155392921369743`*^9}, {3.7174275893888435`*^9, 
   3.7174275903774996`*^9}, {3.7177587139782877`*^9, 3.717758769443482*^9}, {
   3.7177589091734953`*^9, 3.717758915101284*^9}, {3.71775912433186*^9, 
   3.717759143008895*^9}, {3.7177600041873283`*^9, 3.71776000717758*^9}, {
   3.7177600393159933`*^9, 3.717760074193562*^9}, {3.7177604178075657`*^9, 
   3.717760425552268*^9}, {3.7177608346429462`*^9, 3.717760952667162*^9}, {
   3.717761051153139*^9, 3.717761051474156*^9}, {3.717764237668434*^9, 
   3.717764237822198*^9}, {3.717764333461492*^9, 3.717764335744451*^9}, {
   3.717764580382156*^9, 3.717764691243702*^9}, {3.7177647228585863`*^9, 
   3.717764738745339*^9}, {3.7177650291346893`*^9, 3.717765095709544*^9}, {
   3.717843176731586*^9, 3.7178432141648703`*^9}, {3.717843315876593*^9, 
   3.7178433283921947`*^9}, {3.717843370586134*^9, 3.717843385680854*^9}, {
   3.718008020418911*^9, 3.718008038868002*^9}, {3.7180080746507263`*^9, 
   3.718008080148118*^9}, {3.718008340773265*^9, 3.718008350335765*^9}, {
   3.718008488610429*^9, 3.718008513946842*^9}, {3.71800858419067*^9, 
   3.7180085844368763`*^9}, {3.718009429868226*^9, 3.718009430053153*^9}, {
   3.718009657183444*^9, 3.718009799254018*^9}, {3.71800989485186*^9, 
   3.718009910823043*^9}, {3.7180099462753897`*^9, 3.71801003888195*^9}, {
   3.7180100859640102`*^9, 3.718010108265121*^9}, {3.718013138492688*^9, 
   3.718013142079398*^9}, {3.718013175399353*^9, 3.718013175829414*^9}, {
   3.718013243913065*^9, 3.71801327314607*^9}, {3.7180133530835123`*^9, 
   3.7180134082215843`*^9}, {3.718013460322302*^9, 3.7180134956607113`*^9}, {
   3.718013565494573*^9, 3.718013577308302*^9}, {3.718013610453664*^9, 
   3.718013691736142*^9}, {3.718013736669404*^9, 3.718013759326255*^9}, {
   3.718013802005661*^9, 3.718013803730051*^9}, {3.718013857168929*^9, 
   3.718013901864587*^9}, 3.7180140058914022`*^9, {3.7180141348464813`*^9, 
   3.718014135038424*^9}, {3.71801428232696*^9, 3.718014306557164*^9}, {
   3.718014377974903*^9, 3.718014436984733*^9}, {3.71801450006382*^9, 
   3.718014522233783*^9}, {3.7180146087481937`*^9, 3.718014609435863*^9}, {
   3.718014698108447*^9, 3.718014737550911*^9}, {3.718014769057056*^9, 
   3.71801483263058*^9}, {3.718014924497176*^9, 3.7180149384340153`*^9}, {
   3.718014973612878*^9, 3.718014974841785*^9}, {3.718015039463098*^9, 
   3.718015040255973*^9}, 3.718015072933395*^9, {3.7180151234289217`*^9, 
   3.718015129210519*^9}, {3.718015168605158*^9, 3.718015294697186*^9}, {
   3.7180153283134813`*^9, 3.718015385424065*^9}, {3.718015460951683*^9, 
   3.718015463326968*^9}, {3.718015585350978*^9, 3.718015588838051*^9}, {
   3.718015722137353*^9, 3.7180157376351233`*^9}, {3.718016259019678*^9, 
   3.718016278769438*^9}, {3.718016314495524*^9, 3.7180163334371977`*^9}, {
   3.718016451889513*^9, 3.71801645204727*^9}, {3.718016532740862*^9, 
   3.7180165332523413`*^9}, {3.718016607865281*^9, 3.718016614884357*^9}, {
   3.7180171254828157`*^9, 3.7180171274109364`*^9}, {3.7180179958472853`*^9, 
   3.7180180485609493`*^9}, {3.718018082951776*^9, 3.718018083093951*^9}, {
   3.718018118500059*^9, 3.718018147774028*^9}, {3.7180182315612097`*^9, 
   3.718018269379694*^9}, {3.718018309676119*^9, 3.718018333843611*^9}, {
   3.7183606426873007`*^9, 3.718360663879919*^9}, {3.718360715285972*^9, 
   3.718360716899693*^9}, {3.718360898596096*^9, 3.7183608987403383`*^9}, {
   3.718360951084775*^9, 3.718360951263625*^9}, {3.718361243100683*^9, 
   3.7183612891681957`*^9}, 3.7183615797503223`*^9, {3.7183616129166737`*^9, 
   3.7183616198443413`*^9}, {3.7183616874297543`*^9, 3.71836168758214*^9}, {
   3.718362199195142*^9, 3.7183622369890738`*^9}, {3.7183622975843477`*^9, 
   3.718362297732305*^9}, {3.718362366396502*^9, 3.718362366653553*^9}, {
   3.718362404734667*^9, 3.718362406345066*^9}, {3.718362445839924*^9, 
   3.7183624460414333`*^9}, {3.718362481776452*^9, 3.718362487252927*^9}, {
   3.718362533893671*^9, 3.718362535870185*^9}, 3.718362581664062*^9, {
   3.7183626434145308`*^9, 3.718362681083179*^9}, {3.718362717509261*^9, 
   3.71836276960485*^9}, {3.7183628479378*^9, 3.718362886107251*^9}, {
   3.718362950375189*^9, 3.71836295625103*^9}, {3.718363109470312*^9, 
   3.718363111467496*^9}, {3.718364760222913*^9, 3.718364768107523*^9}, {
   3.7183649720664*^9, 3.718364978620718*^9}, {3.7184668120583477`*^9, 
   3.7184668175069623`*^9}, {3.718466934980861*^9, 3.7184669695257683`*^9}, {
   3.718467113368157*^9, 3.7184671385818768`*^9}, 3.7184672137957473`*^9, {
   3.7184673636601257`*^9, 3.7184673977717457`*^9}, {3.7184678691173077`*^9, 
   3.7184679007993164`*^9}, {3.718468004688207*^9, 3.718468068860761*^9}, {
   3.7184681275286646`*^9, 3.7184681664874935`*^9}, {3.7184682669981437`*^9, 
   3.7184682706485643`*^9}, {3.718468495680792*^9, 3.718468554638883*^9}, {
   3.71846886539606*^9, 3.718468866158218*^9}, {3.7184689133208513`*^9, 
   3.7184689243554277`*^9}, {3.7185216569157887`*^9, 3.718521657364794*^9}, {
   3.718620300630083*^9, 3.718620305063179*^9}, {3.718620341457862*^9, 
   3.718620359066177*^9}, {3.7186204133864594`*^9, 3.718620451916348*^9}, {
   3.7186996600748167`*^9, 3.7186996603468*^9}, {3.719233697949257*^9, 
   3.719233705430419*^9}, {3.719236277117216*^9, 3.71923628293926*^9}, {
   3.719907361131851*^9, 3.719907369486238*^9}, {3.7199097886563063`*^9, 
   3.719909794361978*^9}, {3.719909826358759*^9, 3.719909840958726*^9}, {
   3.7204399993757677`*^9, 3.720439999693781*^9}, {3.720707313311001*^9, 
   3.720707319599909*^9}, 3.720707407315337*^9, {3.720709491050598*^9, 
   3.720709512666277*^9}, {3.720709748900989*^9, 3.7207097514963713`*^9}, {
   3.7207098160845337`*^9, 3.720709923527089*^9}, {3.720710029886053*^9, 
   3.7207100371966476`*^9}, {3.720710231174925*^9, 3.720710231727273*^9}, {
   3.7207794395162573`*^9, 3.720779440091707*^9}, {3.7209340239383917`*^9, 
   3.720934023943287*^9}, 3.720954163512784*^9, {3.7213153808771534`*^9, 
   3.721315386473866*^9}, {3.7213154640603404`*^9, 3.7213154660026283`*^9}, {
   3.7213157777087984`*^9, 3.7213158683299227`*^9}, {3.721316005146682*^9, 
   3.7213160054468803`*^9}, {3.7213162839326277`*^9, 
   3.7213162873609076`*^9}, {3.7213163741558027`*^9, 3.721316374288889*^9}, {
   3.721324635283553*^9, 3.7213246484032345`*^9}, {3.7213260367563267`*^9, 
   3.721326054968404*^9}, {3.7213262116072397`*^9, 3.7213262441828375`*^9}, {
   3.721373474754203*^9, 3.7213735052284007`*^9}, 3.721545813870803*^9, {
   3.7465931284696627`*^9, 3.746593169213375*^9}, {3.7465966347010336`*^9, 
   3.746596634796641*^9}, 3.7466315192980957`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"16.191334512601543`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.718364738843885*^9, 3.718364966677202*^9, 3.718365201279017*^9, 
   3.7184679035451326`*^9, {3.7184681381727195`*^9, 3.7184681678493977`*^9}, 
   3.718468586347909*^9, 3.718468908655293*^9, 3.718469241840296*^9, 
   3.718515949511149*^9, 3.7186204243401823`*^9, 3.718620752732387*^9, 
   3.718699632546956*^9, 3.7187001138716516`*^9, 3.7199073698613462`*^9, 
   3.719907615039665*^9, 3.719909738463625*^9, 3.720440987173324*^9, 
   3.720712582205134*^9, 3.720785309871719*^9, 3.721325144873831*^9, 
   3.7213261347232695`*^9, 3.721331558239505*^9, {3.7213734844286103`*^9, 
   3.721373498901207*^9}, 3.721376210422855*^9, 3.746596654870495*^9, 
   3.746600061919222*^9, 3.7472901492698584`*^9}]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Kernels of type ",
 Cell[BoxData[
  FormBox[
   FractionBox["r", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["r", "2"], "-", 
      SuperscriptBox["y", "2"]}]]], TraditionalForm]]]
}], "Chapter",
 CellChangeTimes->{{3.7177548018952417`*^9, 3.717754828938238*^9}, {
  3.717754866660471*^9, 3.717754883528428*^9}, {3.717757220620521*^9, 
  3.717757220707312*^9}, {3.717757269894465*^9, 3.717757269989544*^9}, {
  3.7209340239678917`*^9, 3.720934024102963*^9}, {3.720935258283783*^9, 
  3.720935259324072*^9}}],

Cell["\<\
Singularity treatment of the forward Abel transform. For large y the \
coefficients vary very smoothly with 1/y, so I interpolate in the final code \
instead of pre-calculating and saving a crazy amount of coefficients.\
\>", "Text",
 CellChangeTimes->{{3.7472878856232853`*^9, 3.7472879150978293`*^9}, {
  3.747287982041687*^9, 3.747288089344437*^9}}],

Cell[CellGroupData[{

Cell["Singular end", "Subchapter",
 CellChangeTimes->{
  3.7177572887176*^9, 3.71775731908568*^9, {3.7184700856826878`*^9, 
   3.7184700858485813`*^9}, 3.7209340241403093`*^9, 3.720935260648911*^9}],

Cell[CellGroupData[{

Cell["Small y", "Section",
 CellChangeTimes->{{3.718470012066473*^9, 3.718470014126327*^9}, 
   3.720934024255247*^9, 3.7209352610521812`*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prec", "=", "80"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ordAna", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"err", "=", 
   RowBox[{"10", "^", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "prec"}], "/", "2"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kmax", "=", "19"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nmax", "=", 
   RowBox[{"10", "^", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yIndMax", "=", "128"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"yIndTab", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"ii", ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "0", ",", "yIndMax"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"kInner", "=", 
       RowBox[{"Floor", "[", 
        RowBox[{"k", "/", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"kOuter", "=", 
       RowBox[{"Floor", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k", "-", "1"}], ")"}], "/", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"yInd", "=", 
           RowBox[{"yIndTab", "[", 
            RowBox[{"[", "mm", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"n", "=", 
           RowBox[{"nmax", "+", "yInd"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"h", "=", 
           RowBox[{"R", "/", 
            RowBox[{"(", 
             RowBox[{"n", "-", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"y", "=", 
           RowBox[{"yInd", "*", "h"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"fun", "=", 
           RowBox[{"Simplify", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"r", "-", "y"}], ")"}], "^", 
               RowBox[{"(", 
                RowBox[{"ii", "-", "1"}], ")"}]}], "*", 
              RowBox[{"r", "/", 
               RowBox[{"Sqrt", "[", 
                RowBox[{
                 RowBox[{"r", "^", "2"}], "-", 
                 RowBox[{"y", "^", "2"}]}], "]"}]}]}], ",", 
             RowBox[{"Assumptions", "\[Rule]", 
              RowBox[{"r", ">=", "0"}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"funNoSqrtSing", "=", 
           RowBox[{"Simplify", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"r", "-", "y"}], ")"}], "^", 
               RowBox[{"(", 
                RowBox[{"ii", "-", "1"}], ")"}]}], "*", 
              RowBox[{"r", "/", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"r", "+", "y"}], "]"}]}]}], ",", 
             RowBox[{"Assumptions", "\[Rule]", 
              RowBox[{"r", ">=", "0"}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"funNoSing", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"r", "-", "y"}], ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"ii", "-", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"yInd", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"b", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Total", "[", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{"fun", ",", 
                    RowBox[{"{", 
                    RowBox[{"r", ",", 
                    RowBox[{
                    RowBox[{"2", "*", "ss"}], "-", "1"}]}], "}"}]}], "]"}], 
                    "*", 
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"h", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "ss"}], "-", "1"}], ")"}]}], "*", 
                    RowBox[{
                    RowBox[{"BernoulliB", "[", 
                    RowBox[{"2", "*", "ss"}], "]"}], "/", 
                    RowBox[{"Factorial", "[", 
                    RowBox[{"2", "*", "ss"}], "]"}]}]}], ",", "prec"}], 
                    "]"}]}], "/.", 
                    RowBox[{"r", "\[Rule]", "0"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"ss", ",", "1", ",", 
                    RowBox[{"ii", "-", "1"}]}], "}"}]}], "]"}], ",", 
                   RowBox[{
                   "Method", "\[Rule]", "\"\<CompensatedSummation\>\""}]}], 
                  "]"}], "+", 
                 RowBox[{
                  RowBox[{"1", "/", "2"}], "*", 
                  RowBox[{"(", 
                   RowBox[{"fun", "/.", 
                    RowBox[{"r", "\[Rule]", "0"}]}], ")"}]}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"ii", ",", "1", ",", "k"}], "}"}]}], "]"}]}], ";"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"yInd", "<", "20"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"b", "=", 
              RowBox[{"Table", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"intervals", "=", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"jj", "-", "1"}], ")"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"jj", ",", "1", ",", "nmax"}], "}"}]}], "]"}]}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"arr", "=", 
                  RowBox[{"ConstantArray", "[", 
                   RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{"0", ",", "prec"}], "]"}], ",", 
                    RowBox[{"2", "+", "ordAna"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"arr", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "=", 
                  RowBox[{"NIntegrate", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"fun", "/.", 
                    RowBox[{"r", "\[Rule]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"nInd", "+", "yInd"}], ")"}], "*", "h"}]}]}], 
                    ")"}], "-", 
                    RowBox[{"(", 
                    RowBox[{"fun", "/.", 
                    RowBox[{"r", "\[Rule]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ceiling", "[", "nInd", "]"}], "+", "yInd"}], 
                    ")"}], "*", "h"}]}]}], ")"}]}], ",", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", "nInd", "}"}], ",", "intervals"}], "]"}], 
                    ",", 
                    RowBox[{"PrecisionGoal", "\[Rule]", 
                    RowBox[{"prec", "/", "2"}]}], ",", 
                    RowBox[{"WorkingPrecision", "\[Rule]", "prec"}], ",", 
                    RowBox[{"MaxRecursion", "\[Rule]", "50"}], ",", 
                    RowBox[{"Method", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", 
                    RowBox[{"\"\<SymbolicProcessing\>\"", "\[Rule]", "0"}]}], 
                    "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"arr", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "=", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "2"}], "*", "fun"}], "/.", 
                    RowBox[{"r", "\[Rule]", "R"}]}], ")"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"arr", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "=", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{"fun", ",", 
                    RowBox[{"{", 
                    RowBox[{"r", ",", "1"}], "}"}]}], "]"}], "*", 
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{"h", "*", 
                    RowBox[{
                    RowBox[{"BernoulliB", "[", "2", "]"}], "/", 
                    RowBox[{"Factorial", "[", "2", "]"}]}]}], ",", "prec"}], 
                    "]"}]}], "/.", 
                   RowBox[{"r", "\[Rule]", "R"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"For", "[", 
                  RowBox[{
                   RowBox[{"ll", "=", "2"}], ",", 
                   RowBox[{"ll", "\[LessEqual]", "ordAna"}], ",", 
                   RowBox[{"ll", "++"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", "+", "ll"}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{"fun", ",", 
                    RowBox[{"{", 
                    RowBox[{"r", ",", 
                    RowBox[{
                    RowBox[{"2", "*", "ll"}], "-", "1"}]}], "}"}]}], "]"}], 
                    "*", 
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"h", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "ll"}], "-", "1"}], ")"}]}], "*", 
                    RowBox[{
                    RowBox[{"BernoulliB", "[", 
                    RowBox[{"2", "*", "ll"}], "]"}], "/", 
                    RowBox[{"Factorial", "[", 
                    RowBox[{"2", "*", "ll"}], "]"}]}]}], ",", "prec"}], 
                    "]"}]}], "/.", 
                    RowBox[{"r", "\[Rule]", "R"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"sum", "=", 
                    RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", 
                    RowBox[{"2", "+", "ll"}]}], "]"}], "]"}], ",", 
                    RowBox[{
                    "Method", "\[Rule]", "\"\<CompensatedSummation\>\""}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ll", ">", 
                    RowBox[{"Floor", "[", 
                    RowBox[{"2", "+", 
                    RowBox[{"ii", "/", "2"}]}], "]"}]}], "&&", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", "+", "ll"}], "]"}], "]"}], "]"}], "<=", 
                    RowBox[{"err", "*", 
                    RowBox[{"Abs", "[", "sum", "]"}]}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Break", "[", "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ll", "\[GreaterEqual]", "ordAna"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "yInd", ",", 
                    "\"\<Euler-Mclaurin series possibly not converged.\>\""}],
                     "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                 "sum"}], ",", 
                RowBox[{"{", 
                 RowBox[{"ii", ",", "1", ",", "k"}], "}"}]}], "]"}]}], ";"}], 
            ",", "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"b", "=", 
              RowBox[{"Table", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"arr", "=", 
                  RowBox[{"ConstantArray", "[", 
                   RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{"0", ",", "prec"}], "]"}], ",", 
                    RowBox[{"ordAna", "+", "1"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"arr", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "=", 
                  RowBox[{
                   RowBox[{"funNoSqrtSing", "*", 
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Zeta", "[", 
                    RowBox[{"1", "/", "2"}], "]"}], "*", 
                    RowBox[{"h", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "2"}], ")"}]}]}], ",", "prec"}], 
                    "]"}]}], "/.", 
                   RowBox[{"r", "\[Rule]", "y"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"For", "[", 
                  RowBox[{
                   RowBox[{"ll", "=", "1"}], ",", 
                   RowBox[{"ll", "\[LessEqual]", "ordAna"}], ",", 
                   RowBox[{"ll", "++"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", "+", "ll"}], "]"}], "]"}], "=", 
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{"funNoSqrtSing", ",", 
                    RowBox[{"{", 
                    RowBox[{"r", ",", "ll"}], "}"}]}], "]"}], "*", 
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Zeta", "[", 
                    RowBox[{
                    RowBox[{"1", "/", "2"}], "-", "ll"}], "]"}], "*", 
                    RowBox[{
                    RowBox[{"h", "^", 
                    RowBox[{"(", 
                    RowBox[{"ll", "-", 
                    RowBox[{"1", "/", "2"}]}], ")"}]}], "/", 
                    RowBox[{"Factorial", "[", "ll", "]"}]}]}], ",", "prec"}], 
                    "]"}]}], "/.", 
                    RowBox[{"r", "\[Rule]", "y"}]}], ",", "prec"}], "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"sum", "=", 
                    RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", 
                    RowBox[{"1", "+", "ll"}]}], "]"}], "]"}], ",", 
                    RowBox[{
                    "Method", "\[Rule]", "\"\<CompensatedSummation\>\""}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ll", ">", 
                    RowBox[{"1", "+", "ii"}]}], "&&", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", "+", "ll"}], "]"}], "]"}], "]"}], "<=", 
                    RowBox[{"err", "*", 
                    RowBox[{"Abs", "[", "sum", "]"}]}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Break", "[", "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ll", "\[GreaterEqual]", "ordAna"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "yInd", ",", 
                    "\"\<Euler-Mclaurin series possibly not converged.\>\""}],
                     "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"-", "sum"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"ii", ",", "1", ",", "k"}], "}"}]}], "]"}]}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"A", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"funNoSing", "/.", 
              RowBox[{"r", "\[Rule]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"yInd", "+", "jj"}], ")"}], "*", "h"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"ii", ",", "1", ",", "k"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"jj", ",", 
               RowBox[{"-", "kOuter"}], ",", "kInner"}], "}"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"N", "[", 
           RowBox[{"LinearSolve", "[", 
            RowBox[{"A", ",", "b"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"mm", ",", "1", ",", 
           RowBox[{"Length", "[", "yIndTab", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"Chop", "[", 
        RowBox[{"res", ",", "err"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"StringJoin", "[", 
         RowBox[{"\"\<coeffs_invSqrtDiffSqLin_sing_small_\>\"", ",", 
          RowBox[{"IntegerString", "[", 
           RowBox[{"k", ",", "10", ",", "2"}], "]"}], ",", "\"\<.h5\>\""}], 
         "]"}], ",", "res"}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "kmax", ",", "1"}], "}"}]}], "]"}], ";"}], "//",
   "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.718471989890789*^9, 3.7184719979731436`*^9}, {
   3.718472138835555*^9, 3.7184721525256343`*^9}, {3.718472460018538*^9, 
   3.718472470219298*^9}, {3.7184727521812763`*^9, 3.718472752706625*^9}, {
   3.7184732080965996`*^9, 3.7184732450060763`*^9}, {3.7184735419529824`*^9, 
   3.718473542035041*^9}, {3.718642391647255*^9, 3.718642391895194*^9}, {
   3.7186425126144867`*^9, 3.718642539939292*^9}, {3.718643086751134*^9, 
   3.7186430900506687`*^9}, {3.718645422512672*^9, 3.7186454227990227`*^9}, 
   3.718696938521366*^9, {3.718961845359117*^9, 3.718961845592506*^9}, {
   3.7202644249826097`*^9, 3.720264427042261*^9}, {3.720266935102071*^9, 
   3.720267090087277*^9}, {3.720267128436555*^9, 3.720267137617923*^9}, {
   3.720267171242806*^9, 3.720267211433264*^9}, {3.7202690715269537`*^9, 
   3.720269078702075*^9}, {3.7202707732535267`*^9, 3.7202708616827183`*^9}, {
   3.7202709002074623`*^9, 3.720270963099832*^9}, {3.720271107812818*^9, 
   3.720271109931691*^9}, {3.7202719412726593`*^9, 3.720272045447665*^9}, {
   3.720272102999*^9, 3.720272106306027*^9}, {3.720272177126067*^9, 
   3.7202722574161158`*^9}, {3.7202723483318167`*^9, 3.7202723879731407`*^9}, 
   3.720272498397957*^9, {3.720272563777452*^9, 3.720272581672607*^9}, {
   3.720272662565556*^9, 3.7202726637846127`*^9}, {3.720272714239217*^9, 
   3.720272714379681*^9}, {3.720285278801832*^9, 3.720285285617342*^9}, {
   3.720448955745727*^9, 3.7204489569900217`*^9}, {3.720606672887506*^9, 
   3.720606681241007*^9}, {3.720607821968292*^9, 3.720607842864077*^9}, {
   3.720616660330385*^9, 3.720616662880501*^9}, {3.720616861879002*^9, 
   3.720616862067862*^9}, {3.7206169339536247`*^9, 3.720616947628991*^9}, {
   3.720617017165596*^9, 3.720617077711866*^9}, {3.720617115801054*^9, 
   3.720617127674078*^9}, {3.720621667704871*^9, 3.720621708264797*^9}, {
   3.720621749910529*^9, 3.720621750080724*^9}, {3.720625487208968*^9, 
   3.7206255044029713`*^9}, {3.720625648035873*^9, 3.7206256567555447`*^9}, {
   3.720626813830098*^9, 3.7206268139788437`*^9}, {3.720627992783229*^9, 
   3.7206279941882143`*^9}, {3.720629042161683*^9, 3.7206290649392567`*^9}, {
   3.72062913921812*^9, 3.720629139722768*^9}, {3.720629408473379*^9, 
   3.720629442138999*^9}, {3.720629601671196*^9, 3.720629602454349*^9}, {
   3.720635396056142*^9, 3.720635425472004*^9}, {3.720635528456625*^9, 
   3.7206355296425*^9}, {3.720637470498969*^9, 3.720637496023485*^9}, {
   3.720637581938581*^9, 3.720637589162951*^9}, {3.720637717950459*^9, 
   3.720637718500958*^9}, {3.720638173539885*^9, 3.720638174258007*^9}, {
   3.720682659848254*^9, 3.720682673541843*^9}, {3.7206828731338778`*^9, 
   3.720682921446822*^9}, {3.720682967995179*^9, 3.720682979003544*^9}, {
   3.720683095724469*^9, 3.720683164596075*^9}, {3.7206832266494093`*^9, 
   3.7206833060615797`*^9}, {3.7206833694796057`*^9, 3.720683389755145*^9}, {
   3.720683438246131*^9, 3.720683479049657*^9}, {3.720683519841331*^9, 
   3.7206835234433327`*^9}, {3.720683582682539*^9, 3.720683594130582*^9}, {
   3.72068368728664*^9, 3.720683687541478*^9}, {3.7206837264542027`*^9, 
   3.720683737118294*^9}, {3.720683778462471*^9, 3.720683795926656*^9}, {
   3.720683848482685*^9, 3.720683902154455*^9}, {3.720683932227162*^9, 
   3.7206840027183437`*^9}, {3.720684039210885*^9, 3.7206840508269043`*^9}, {
   3.720684081678876*^9, 3.72068409823076*^9}, {3.720684136805415*^9, 
   3.720684138039647*^9}, {3.7206842421179333`*^9, 3.720684243380007*^9}, {
   3.7207062893946333`*^9, 3.7207063837086077`*^9}, {3.720706415902021*^9, 
   3.720706424312744*^9}, {3.720706466807208*^9, 3.7207065147925997`*^9}, {
   3.720706699338016*^9, 3.720706707676508*^9}, 3.7207139844379997`*^9, {
   3.7207793605796833`*^9, 3.720779360858508*^9}, {3.7209340243439913`*^9, 
   3.720934024361314*^9}, {3.720953015513442*^9, 3.720953017817992*^9}, 
   3.7209541636106787`*^9, 3.721022809711211*^9, {3.7213160130949564`*^9, 
   3.7213160189948673`*^9}, {3.7213160638776493`*^9, 
   3.7213161211896667`*^9}, {3.721316152655539*^9, 3.7213161744870224`*^9}, {
   3.7213162321522837`*^9, 3.721316323237704*^9}, {3.7213163854156094`*^9, 
   3.721316413074953*^9}, {3.721316528962858*^9, 3.7213165761924953`*^9}, {
   3.7213168275382476`*^9, 3.7213168380452147`*^9}, {3.721324327493385*^9, 
   3.7213243279366765`*^9}, {3.7213246352915583`*^9, 3.721324648409238*^9}, 
   3.721324702754739*^9, {3.721325458034465*^9, 3.7213254781738157`*^9}, {
   3.721325588934442*^9, 3.721325599422393*^9}, 3.721325700606474*^9, {
   3.7213257884867363`*^9, 3.721325789324291*^9}, {3.721326244201849*^9, 
   3.7213262442138567`*^9}, {3.7213263125461564`*^9, 
   3.7213263179227257`*^9}, {3.721326414618826*^9, 3.7213264182322245`*^9}, {
   3.72137472161489*^9, 3.721374731754613*^9}, {3.721374944180785*^9, 
   3.7213751025087495`*^9}, {3.7213751717566557`*^9, 
   3.7213751769340887`*^9}, {3.721375783943675*^9, 3.721375791902244*^9}, {
   3.721386867002213*^9, 3.7213869036375*^9}, {3.721388161331849*^9, 
   3.721388205924951*^9}, {3.7213882733419523`*^9, 3.721388279618639*^9}, {
   3.721388547560117*^9, 3.721388561830614*^9}, {3.72138866133048*^9, 
   3.721388661658684*^9}, {3.721388794082336*^9, 3.72138880442472*^9}, {
   3.7213948762315807`*^9, 3.721394878970561*^9}, {3.721464395407957*^9, 
   3.721464406075698*^9}, {3.721464444965308*^9, 3.721464448691272*^9}, {
   3.7214670478779697`*^9, 3.721467048194879*^9}, {3.721467171855472*^9, 
   3.72146717211062*^9}, {3.721545813908848*^9, 3.721545813941828*^9}, {
   3.721547179709755*^9, 3.721547251521358*^9}, {3.7215473366495857`*^9, 
   3.7215474257176027`*^9}, 3.7215474933347673`*^9, {3.721549830526012*^9, 
   3.721549832498665*^9}, {3.746596674830135*^9, 3.746596714709428*^9}, {
   3.7465988945303154`*^9, 3.7465988985446143`*^9}, 3.7466315193254128`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"620.602083475004`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.721388017151552*^9, 3.721388212800432*^9, 
  3.721388283967185*^9, 3.721388586193712*^9, 3.721388755784637*^9, 
  3.721388991443563*^9, 3.7214671625447693`*^9, 3.721467389273459*^9, 
  3.721467531211226*^9, 3.721468534261793*^9, 3.721547333688397*^9, 
  3.721547408081448*^9, 3.721547670858618*^9, 3.7466007978668985`*^9, 
  3.7472907699557095`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prec", "=", "80"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ordAna", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"err", "=", 
   RowBox[{"10", "^", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "prec"}], "/", "2"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kmax", "=", "19"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nmax", "=", 
   RowBox[{"10", "^", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yIndMax", "=", "128"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"yIndTab", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"1", "/", "2"}], "+", "ii"}], ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "0", ",", "yIndMax"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"kInner", "=", 
       RowBox[{"Floor", "[", 
        RowBox[{"k", "/", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"kOuter", "=", 
       RowBox[{"Floor", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k", "-", "1"}], ")"}], "/", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"yInd", "=", 
           RowBox[{"yIndTab", "[", 
            RowBox[{"[", "mm", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"n", "=", 
           RowBox[{"nmax", "+", "yInd"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"h", "=", 
           RowBox[{"R", "/", 
            RowBox[{"(", 
             RowBox[{"n", "-", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"y", "=", 
           RowBox[{"yInd", "*", "h"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"fun", "=", 
           RowBox[{"Simplify", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"r", "-", "y"}], ")"}], "^", 
               RowBox[{"(", 
                RowBox[{"ii", "-", "1"}], ")"}]}], "*", 
              RowBox[{"r", "/", 
               RowBox[{"Sqrt", "[", 
                RowBox[{
                 RowBox[{"r", "^", "2"}], "-", 
                 RowBox[{"y", "^", "2"}]}], "]"}]}]}], ",", 
             RowBox[{"Assumptions", "\[Rule]", 
              RowBox[{"r", ">=", "0"}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"funNoSqrtSing", "=", 
           RowBox[{"Simplify", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"r", "-", "y"}], ")"}], "^", 
               RowBox[{"(", 
                RowBox[{"ii", "-", "1"}], ")"}]}], "*", 
              RowBox[{"r", "/", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"r", "+", "y"}], "]"}]}]}], ",", 
             RowBox[{"Assumptions", "\[Rule]", 
              RowBox[{"r", ">=", "0"}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"funNoSing", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"r", "-", "y"}], ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"ii", "-", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"yInd", "<", "20"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"b", "=", 
              RowBox[{"Table", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"intervals", "=", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"jj", "-", "1"}], ")"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"jj", ",", "1", ",", "nmax"}], "}"}]}], "]"}]}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"arr", "=", 
                  RowBox[{"ConstantArray", "[", 
                   RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{"0", ",", "prec"}], "]"}], ",", 
                    RowBox[{"2", "+", "ordAna"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"arr", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "=", 
                  RowBox[{"NIntegrate", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"fun", "/.", 
                    RowBox[{"r", "\[Rule]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"nInd", "+", "yInd"}], ")"}], "*", "h"}]}]}], 
                    ")"}], "-", 
                    RowBox[{"(", 
                    RowBox[{"fun", "/.", 
                    RowBox[{"r", "\[Rule]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ceiling", "[", "nInd", "]"}], "+", "yInd"}], 
                    ")"}], "*", "h"}]}]}], ")"}]}], ",", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", "nInd", "}"}], ",", "intervals"}], "]"}], 
                    ",", 
                    RowBox[{"PrecisionGoal", "\[Rule]", 
                    RowBox[{"prec", "/", "2"}]}], ",", 
                    RowBox[{"WorkingPrecision", "\[Rule]", "prec"}], ",", 
                    RowBox[{"MaxRecursion", "\[Rule]", "50"}], ",", 
                    RowBox[{"Method", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", 
                    RowBox[{"\"\<SymbolicProcessing\>\"", "\[Rule]", "0"}]}], 
                    "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"arr", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "=", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{"1", "/", "2"}], ",", "prec"}], "]"}], "*", 
                    "fun"}], "/.", 
                    RowBox[{"r", "\[Rule]", "R"}]}], ")"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"arr", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "=", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{"fun", ",", 
                    RowBox[{"{", 
                    RowBox[{"r", ",", "1"}], "}"}]}], "]"}], "*", 
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{"h", "*", 
                    RowBox[{
                    RowBox[{"BernoulliB", "[", "2", "]"}], "/", 
                    RowBox[{"Factorial", "[", "2", "]"}]}]}], ",", "prec"}], 
                    "]"}]}], "/.", 
                   RowBox[{"r", "\[Rule]", "R"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"For", "[", 
                  RowBox[{
                   RowBox[{"ll", "=", "2"}], ",", 
                   RowBox[{"ll", "\[LessEqual]", "ordAna"}], ",", 
                   RowBox[{"ll", "++"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", "+", "ll"}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{"fun", ",", 
                    RowBox[{"{", 
                    RowBox[{"r", ",", 
                    RowBox[{
                    RowBox[{"2", "*", "ll"}], "-", "1"}]}], "}"}]}], "]"}], 
                    "*", 
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"h", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "ll"}], "-", "1"}], ")"}]}], "*", 
                    RowBox[{
                    RowBox[{"BernoulliB", "[", 
                    RowBox[{"2", "*", "ll"}], "]"}], "/", 
                    RowBox[{"Factorial", "[", 
                    RowBox[{"2", "*", "ll"}], "]"}]}]}], ",", "prec"}], 
                    "]"}]}], "/.", 
                    RowBox[{"r", "\[Rule]", "R"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"sum", "=", 
                    RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", 
                    RowBox[{"2", "+", "ll"}]}], "]"}], "]"}], ",", 
                    RowBox[{
                    "Method", "\[Rule]", "\"\<CompensatedSummation\>\""}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ll", ">", 
                    RowBox[{"Floor", "[", 
                    RowBox[{"2", "+", 
                    RowBox[{"ii", "/", "2"}]}], "]"}]}], "&&", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", "+", "ll"}], "]"}], "]"}], "]"}], "<=", 
                    RowBox[{"err", "*", 
                    RowBox[{"Abs", "[", "sum", "]"}]}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Break", "[", "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ll", "\[GreaterEqual]", "ordAna"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "yInd", ",", 
                    "\"\<Euler-Mclaurin series possibly not converged.\>\""}],
                     "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                 "sum"}], ",", 
                RowBox[{"{", 
                 RowBox[{"ii", ",", "1", ",", "k"}], "}"}]}], "]"}]}], ";"}], 
            "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"b", "=", 
              RowBox[{"Table", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"arr", "=", 
                  RowBox[{"ConstantArray", "[", 
                   RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{"0", ",", "prec"}], "]"}], ",", 
                    RowBox[{"ordAna", "+", "1"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"arr", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "=", 
                  RowBox[{
                   RowBox[{"funNoSqrtSing", "*", 
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Zeta", "[", 
                    RowBox[{"1", "/", "2"}], "]"}], "*", 
                    RowBox[{"h", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "2"}], ")"}]}]}], ",", "prec"}], 
                    "]"}]}], "/.", 
                   RowBox[{"r", "\[Rule]", "y"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"For", "[", 
                  RowBox[{
                   RowBox[{"ll", "=", "1"}], ",", 
                   RowBox[{"ll", "\[LessEqual]", "ordAna"}], ",", 
                   RowBox[{"ll", "++"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", "+", "ll"}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{"funNoSqrtSing", ",", 
                    RowBox[{"{", 
                    RowBox[{"r", ",", "ll"}], "}"}]}], "]"}], "*", 
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Zeta", "[", 
                    RowBox[{
                    RowBox[{"1", "/", "2"}], "-", "ll"}], "]"}], "*", 
                    RowBox[{
                    RowBox[{"h", "^", 
                    RowBox[{"(", 
                    RowBox[{"ll", "-", 
                    RowBox[{"1", "/", "2"}]}], ")"}]}], "/", 
                    RowBox[{"Factorial", "[", "ll", "]"}]}]}], ",", "prec"}], 
                    "]"}]}], "/.", 
                    RowBox[{"r", "\[Rule]", "y"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"sum", "=", 
                    RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", 
                    RowBox[{"1", "+", "ll"}]}], "]"}], "]"}], ",", 
                    RowBox[{
                    "Method", "\[Rule]", "\"\<CompensatedSummation\>\""}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ll", ">", 
                    RowBox[{"1", "+", "ii"}]}], "&&", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", "+", "ll"}], "]"}], "]"}], "]"}], "<=", 
                    RowBox[{"err", "*", 
                    RowBox[{"Abs", "[", "sum", "]"}]}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Break", "[", "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ll", "\[GreaterEqual]", "ordAna"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "yInd", ",", 
                    "\"\<Euler-Mclaurin series possibly not converged.\>\""}],
                     "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"-", "sum"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"ii", ",", "1", ",", "k"}], "}"}]}], "]"}]}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"A", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"funNoSing", "/.", 
              RowBox[{"r", "\[Rule]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"yInd", "+", "jj"}], ")"}], "*", "h"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"ii", ",", "1", ",", "k"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"jj", ",", 
               RowBox[{"-", "kOuter"}], ",", "kInner"}], "}"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"N", "[", 
           RowBox[{"LinearSolve", "[", 
            RowBox[{"A", ",", "b"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"mm", ",", "1", ",", 
           RowBox[{"Length", "[", "yIndTab", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"Chop", "[", 
        RowBox[{"res", ",", "err"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"StringJoin", "[", 
         RowBox[{"\"\<coeffs_invSqrtDiffSqLin_sing_small_halfShift_\>\"", ",", 
          RowBox[{"IntegerString", "[", 
           RowBox[{"k", ",", "10", ",", "2"}], "]"}], ",", "\"\<.h5\>\""}], 
         "]"}], ",", "res"}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "kmax", ",", "1"}], "}"}]}], "]"}], ";"}], "//",
   "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.7202623576663837`*^9, 3.7202623624584713`*^9}, {
   3.720262413236515*^9, 3.720262414381234*^9}, {3.720262497536972*^9, 
   3.720262498248596*^9}, {3.72026253413792*^9, 3.72026253551213*^9}, {
   3.720262619420191*^9, 3.7202626245206013`*^9}, {3.720263079682765*^9, 
   3.7202630893481894`*^9}, {3.7202631542063828`*^9, 3.720263206764176*^9}, {
   3.7202632557456512`*^9, 3.72026339069245*^9}, {3.720263427376861*^9, 
   3.720263458308584*^9}, {3.720263612681045*^9, 3.720263633621195*^9}, {
   3.720263877477725*^9, 3.720263879357451*^9}, {3.720263957211768*^9, 
   3.720263961225602*^9}, {3.720271385699242*^9, 3.720271391155657*^9}, {
   3.72027145186655*^9, 3.720271495457625*^9}, {3.720271573739019*^9, 
   3.720271580046077*^9}, {3.720271683188286*^9, 3.720271685956151*^9}, {
   3.720271728442789*^9, 3.720271735174266*^9}, {3.720271845994583*^9, 
   3.72027184862389*^9}, {3.720271907551126*^9, 3.720271907912381*^9}, {
   3.7202841516084337`*^9, 3.720284181168743*^9}, {3.720284838076559*^9, 
   3.720284863666751*^9}, {3.720285026952745*^9, 3.720285027373744*^9}, {
   3.7202851241255913`*^9, 3.720285164002942*^9}, {3.720285246582374*^9, 
   3.720285252038666*^9}, {3.720285311429324*^9, 3.720285312782075*^9}, {
   3.720449002598144*^9, 3.7204490028756332`*^9}, {3.7206074206585703`*^9, 
   3.7206074221349773`*^9}, {3.720607799858944*^9, 3.720607814308754*^9}, {
   3.720617151842688*^9, 3.7206171800719643`*^9}, {3.720617226386244*^9, 
   3.720617227417454*^9}, {3.720621391224712*^9, 3.720621397449583*^9}, {
   3.72070673563756*^9, 3.720706769403591*^9}, {3.720712651658946*^9, 
   3.720712654051505*^9}, 3.720713979555107*^9, {3.720779367320842*^9, 
   3.72077936759571*^9}, {3.72093402437903*^9, 3.720934024396068*^9}, {
   3.720952976362496*^9, 3.7209529885453167`*^9}, 3.720954163636585*^9, 
   3.7210228097220182`*^9, {3.7213167214288454`*^9, 3.7213167280242248`*^9}, {
   3.721316764135178*^9, 3.7213168038725414`*^9}, {3.7213168693769984`*^9, 
   3.7213169146610394`*^9}, {3.7213169594307404`*^9, 3.721316959545816*^9}, {
   3.721323883287899*^9, 3.721323961330635*^9}, {3.7213243391200886`*^9, 
   3.7213243392771916`*^9}, {3.7213246352985616`*^9, 
   3.7213246484162436`*^9}, {3.721326244229868*^9, 3.7213262442388735`*^9}, {
   3.7213263324603615`*^9, 3.721326336715179*^9}, {3.7213265102073135`*^9, 
   3.7213265175862103`*^9}, {3.7213265957035956`*^9, 
   3.7213265958496947`*^9}, {3.7213266365336637`*^9, 
   3.7213266432371097`*^9}, {3.721375185603834*^9, 3.7213752214706135`*^9}, {
   3.721375807691678*^9, 3.721375818262362*^9}, {3.721375911906311*^9, 
   3.721375916634522*^9}, {3.7213888172423267`*^9, 3.721388821920019*^9}, 
   3.72138897935135*^9, 3.7213949105503807`*^9, {3.721545813953107*^9, 
   3.721545813963031*^9}, {3.721546964762764*^9, 3.721547075243083*^9}, {
   3.721547293909886*^9, 3.7215472941521053`*^9}, {3.7215475723437157`*^9, 
   3.7215475907822943`*^9}, {3.7465967168060713`*^9, 3.746596733214384*^9}, {
   3.7465989308959923`*^9, 3.746598936049635*^9}, 3.7466315193493805`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"772.9631498126819`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.7202636776040382`*^9, 3.720263942120448*^9, 
  3.7202708213069973`*^9, 3.72028422289999*^9, 3.720285099440126*^9, 
  3.720285131903027*^9, 3.72028525707063*^9, 3.72028573202836*^9, 
  3.720451466960186*^9, 3.7206083505273323`*^9, 3.72061685690168*^9, 
  3.720618628021886*^9, 3.7207078000962276`*^9, 3.7207819718346033`*^9, 
  3.7213265043895187`*^9, 3.721326574582593*^9, 3.721326615916994*^9, 
  3.7214220963907003`*^9, 3.7215479528849487`*^9, 3.7466016378163514`*^9, 
  3.747291542991583*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Large ",
 StyleBox["y", "Section"]
}], "Section",
 CellChangeTimes->{{3.717757303877178*^9, 3.717757317430648*^9}, 
   3.718470148374695*^9, 3.720934024420993*^9, 3.720935268403726*^9}],

Cell["Typical evaluation time: Minutes", "Text",
 CellChangeTimes->{{3.7186958253185673`*^9, 3.7186958323994417`*^9}, {
  3.720934024549333*^9, 3.7209340246882563`*^9}, {3.7209352686690903`*^9, 
  3.72093526945231*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"prec", "=", "80"}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"R", " ", "=", " ", "1"}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"nmax", " ", "=", " ", 
    RowBox[{"10", "^", "2"}]}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ordAna", " ", "=", " ", "100"}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"err", " ", "=", " ", 
    RowBox[{"10", "^", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "prec"}], "/", "2"}], ")"}]}]}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"kmax", " ", "=", " ", "19"}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"yCross", " ", "=", " ", "128"}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"yInvCount", " ", "=", " ", "256"}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"yInvTable", " ", "=", " ", 
    RowBox[{
     RowBox[{"Range", "[", "yInvCount", "]"}], "/", 
     RowBox[{"(", 
      RowBox[{"yInvCount", "*", "yCross"}], ")"}]}]}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"yIndTab", " ", "=", " ", 
    RowBox[{"1", "/", "yInvTable"}]}], ";"}], " ", 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"kInner", "=", 
       RowBox[{"Floor", "[", 
        RowBox[{"k", "/", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"kOuter", "=", 
       RowBox[{"Floor", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k", "-", "1"}], ")"}], "/", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fun", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x", "-", "1"}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"ii", "-", "1"}], ")"}]}], "/", 
        RowBox[{"Sqrt", "[", "x", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"funNoSing", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x", "-", "1"}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"ii", "-", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"10", "^", "3"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xmax", "=", 
       RowBox[{"N", "[", 
        RowBox[{"1", ",", "prec"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"h", "=", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"n", "-", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"b0", "=", 
       RowBox[{"-", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"funNoSing", ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "ss"}], "}"}]}], "]"}], "*", 
              RowBox[{"N", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Zeta", "[", 
                  RowBox[{
                   RowBox[{"1", "/", "2"}], "-", "ss"}], "]"}], "*", 
                 RowBox[{
                  RowBox[{"h", "^", 
                   RowBox[{"(", 
                    RowBox[{"ss", "-", 
                    RowBox[{"1", "/", "2"}]}], ")"}]}], "/", 
                  RowBox[{"Factorial", "[", "ss", "]"}]}]}], ",", "prec"}], 
               "]"}]}], "/.", 
             RowBox[{"x", "\[Rule]", "0"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"ss", ",", "0", ",", 
              RowBox[{"ii", "-", "1"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", "k"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"A0", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"N", "[", 
          RowBox[{
           RowBox[{"funNoSing", "/.", 
            RowBox[{"x", "\[Rule]", 
             RowBox[{"jj", "*", "h"}]}]}], ",", "prec"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "k"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", 
           RowBox[{"-", "kOuter"}], ",", "kInner"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"A0", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", ";;"}], "]"}], "]"}], "=", 
       RowBox[{"N", "[", 
        RowBox[{"1", ",", "prec"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"resSqrt", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"LinearSolve", "[", 
          RowBox[{"A0", ",", "b0"}], "]"}], "*", 
         RowBox[{"h", "^", 
          RowBox[{"(", 
           RowBox[{"1", "/", "2"}], ")"}]}]}], "//", "N"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"res", " ", "=", " ", 
       RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"yInd", " ", "=", " ", 
           RowBox[{"yIndTab", "[", 
            RowBox[{"[", "mm", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"n", " ", "=", " ", 
           RowBox[{"nmax", " ", "+", " ", "yInd"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"h", " ", "=", " ", 
           RowBox[{"R", "/", 
            RowBox[{"(", 
             RowBox[{"n", " ", "-", " ", "1"}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"y", " ", "=", " ", 
           RowBox[{"yInd", "*", "h"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"fun", " ", "=", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"r", " ", "-", " ", "y"}], ")"}], "^", 
               RowBox[{"(", 
                RowBox[{"ii", " ", "-", " ", "1"}], ")"}]}], "*", "r"}], 
             ")"}], "/", 
            RowBox[{"Sqrt", "[", 
             RowBox[{
              RowBox[{"r", "^", "2"}], " ", "-", " ", 
              RowBox[{"y", "^", "2"}]}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"funNoSqrtSing", " ", "=", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"r", " ", "-", " ", "y"}], ")"}], "^", 
               RowBox[{"(", 
                RowBox[{"ii", " ", "-", " ", "1"}], ")"}]}], "*", "r"}], 
             ")"}], "/", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"r", " ", "+", " ", "y"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"funNoSing", " ", "=", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"r", " ", "-", " ", "y"}], ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"ii", " ", "-", " ", "1"}], ")"}]}]}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"b", "=", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"arr", "=", 
               RowBox[{"ConstantArray", "[", 
                RowBox[{
                 RowBox[{"N", "[", 
                  RowBox[{"0", ",", "prec"}], "]"}], ",", 
                 RowBox[{"ordAna", "+", "1"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"arr", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{"funNoSqrtSing", "*", 
                 RowBox[{"N", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Zeta", "[", 
                    RowBox[{"1", "/", "2"}], "]"}], "*", 
                    RowBox[{"h", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "2"}], ")"}]}]}], ",", "prec"}], 
                  "]"}]}], "/.", 
                RowBox[{"r", "\[Rule]", "y"}]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"ll", "=", "1"}], ",", 
                RowBox[{"ll", "\[LessEqual]", "ordAna"}], ",", 
                RowBox[{"ll", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"arr", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", "+", "ll"}], "]"}], "]"}], "=", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{"funNoSqrtSing", ",", 
                    RowBox[{"{", 
                    RowBox[{"r", ",", "ll"}], "}"}]}], "]"}], "*", 
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Zeta", "[", 
                    RowBox[{
                    RowBox[{"1", "/", "2"}], "-", "ll"}], "]"}], "*", 
                    RowBox[{
                    RowBox[{"h", "^", 
                    RowBox[{"(", 
                    RowBox[{"ll", "-", 
                    RowBox[{"1", "/", "2"}]}], ")"}]}], "/", 
                    RowBox[{"Factorial", "[", "ll", "]"}]}]}], ",", "prec"}], 
                    "]"}]}], "/.", 
                   RowBox[{"r", "\[Rule]", "y"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"sum", "=", 
                  RowBox[{"Total", "[", 
                   RowBox[{
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", 
                    RowBox[{"1", "+", "ll"}]}], "]"}], "]"}], ",", 
                    RowBox[{
                    "Method", "\[Rule]", "\"\<CompensatedSummation\>\""}]}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"ll", ">", 
                    RowBox[{"1", "+", "ii"}]}], "&&", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", "+", "ll"}], "]"}], "]"}], "]"}], "<=", 
                    RowBox[{"err", "*", 
                    RowBox[{"Abs", "[", "sum", "]"}]}]}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Break", "[", "]"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ll", "\[GreaterEqual]", "ordAna"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "Print", "[", 
                    "\"\<Euler-Mclaurin series possibly not converged.\>\"", 
                    "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"-", "sum"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"ii", ",", "1", ",", "k"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"A", " ", "=", " ", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"funNoSing", " ", "/.", " ", 
              RowBox[{"r", " ", "\[Rule]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"yInd", "+", " ", "jj"}], ")"}], "*", "h"}]}]}], ",",
              " ", 
             RowBox[{"{", 
              RowBox[{"ii", ",", " ", "1", ",", " ", "k"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"jj", ",", " ", 
               RowBox[{"-", "kOuter"}], " ", ",", " ", "kInner"}], "}"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{"LinearSolve", "[", 
             RowBox[{"A", ",", " ", "b"}], "]"}], "*", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"2", "/", "yInd"}], "]"}]}], "]"}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"mm", ",", " ", "1", ",", " ", 
           RowBox[{"Length", "[", "yIndTab", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "resSqrt", "}"}], ",", "res"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"StringJoin", "[", 
         RowBox[{"\"\<coeffs_invSqrtDiffSqLin_sing_large_\>\"", ",", " ", 
          RowBox[{"IntegerString", "[", 
           RowBox[{"k", ",", " ", "10", ",", " ", "2"}], "]"}], ",", " ", 
          "\"\<.h5\>\""}], "]"}], ",", " ", "res"}], "]"}]}], 
     "\[IndentingNewLine]", ",", " ", 
     RowBox[{"{", 
      RowBox[{"k", ",", " ", "1", ",", "kmax", ",", " ", "1"}], "}"}]}], 
    "]"}], ";"}], " ", "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.718470119845031*^9, 3.718470142631823*^9}, {
   3.718470995624196*^9, 3.718471024096393*^9}, {3.71847194332491*^9, 
   3.7184719436010933`*^9}, {3.718692295668565*^9, 3.718692323024507*^9}, {
   3.718692354711885*^9, 3.718692385226569*^9}, {3.718692461649138*^9, 
   3.718692464856782*^9}, {3.71869251143152*^9, 3.718692528805977*^9}, {
   3.7186925932679873`*^9, 3.718692596627604*^9}, {3.7186929962302513`*^9, 
   3.718693100046077*^9}, {3.718693130871996*^9, 3.718693174376343*^9}, {
   3.718693230210224*^9, 3.718693281080577*^9}, {3.718694210536693*^9, 
   3.718694210654372*^9}, {3.7186942654892406`*^9, 3.718694271731572*^9}, {
   3.7186943188441753`*^9, 3.718694345714872*^9}, {3.718694388004784*^9, 
   3.7186945529769497`*^9}, {3.718694585699533*^9, 3.718694751932413*^9}, {
   3.7186951508245983`*^9, 3.7186951592296257`*^9}, {3.718695300390905*^9, 
   3.718695313231176*^9}, {3.718695343520998*^9, 3.718695376245453*^9}, {
   3.7186954143796873`*^9, 3.7186954270442457`*^9}, {3.718695460934886*^9, 
   3.7186954617156563`*^9}, 3.7186967076496*^9, 3.718696802357465*^9, {
   3.7186968553333273`*^9, 3.7186968804792233`*^9}, {3.718696915264381*^9, 
   3.71869692671775*^9}, {3.718963042649477*^9, 3.71896305131319*^9}, {
   3.718963278136915*^9, 3.7189633028742533`*^9}, 3.718963349249007*^9, {
   3.7189650232785273`*^9, 3.718965074168202*^9}, {3.718965114463894*^9, 
   3.7189651357437572`*^9}, {3.7189651807851257`*^9, 3.718965239184449*^9}, {
   3.7189652711417427`*^9, 3.718965279447239*^9}, {3.718965470094173*^9, 
   3.718965503061021*^9}, {3.7189658038151817`*^9, 3.718965826311257*^9}, {
   3.718965963864696*^9, 3.718965965978759*^9}, {3.718966017878533*^9, 
   3.718966038350066*^9}, {3.718966151777411*^9, 3.718966164956162*^9}, {
   3.720263910951861*^9, 3.720263911032856*^9}, {3.7203538000822067`*^9, 
   3.720353826215727*^9}, {3.720354164182892*^9, 3.7203541701534863`*^9}, {
   3.720354201010661*^9, 3.720354210574246*^9}, {3.720354267786862*^9, 
   3.720354268122677*^9}, {3.720355468335887*^9, 3.720355568394497*^9}, {
   3.720448972352212*^9, 3.720448972820321*^9}, {3.720607404737762*^9, 
   3.720607407506626*^9}, {3.720607574038663*^9, 3.72060757838085*^9}, {
   3.720608351977248*^9, 3.7206083595445747`*^9}, {3.7207068456267347`*^9, 
   3.72070686159157*^9}, {3.720779382867199*^9, 3.720779382980262*^9}, {
   3.720934024700068*^9, 3.720934025425065*^9}, 3.720935156355673*^9, {
   3.720935272939045*^9, 3.7209352875546837`*^9}, {3.721323983419278*^9, 
   3.72132400633547*^9}, 3.721324383875261*^9, 3.721324648422247*^9, {
   3.721326244245878*^9, 3.7213262442508817`*^9}, {3.7213266551430063`*^9, 
   3.7213267546519747`*^9}, {3.721326794565428*^9, 3.7213268504104557`*^9}, {
   3.7213269221770267`*^9, 3.721327011618327*^9}, {3.721459188959179*^9, 
   3.7214591992433*^9}, {3.721545717839365*^9, 3.721545739718911*^9}, 
   3.721545813388565*^9, {3.7215460365465307`*^9, 3.721546041917088*^9}, {
   3.7215460899148684`*^9, 3.721546093656292*^9}, {3.721546264767722*^9, 
   3.721546269772998*^9}, {3.7215464127948933`*^9, 3.7215464242019997`*^9}, {
   3.721546663358924*^9, 3.7215467842274017`*^9}, {3.7215468289241323`*^9, 
   3.721546868912324*^9}, {3.721546911105152*^9, 3.7215469139958878`*^9}, {
   3.721546974235465*^9, 3.721546974477503*^9}, {3.721547089232777*^9, 
   3.7215471392520237`*^9}, {3.746597091828433*^9, 3.746597113332515*^9}, 
   3.746597232827918*^9, {3.7465992574628315`*^9, 3.7465992631995554`*^9}, {
   3.746599295487695*^9, 3.7465993001762333`*^9}, 3.746631519379618*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"132.26270034589908`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.721546880297613*^9, 3.721546950468796*^9, 
  3.72154702724271*^9, 3.721547200426264*^9, 3.746601787846962*^9, 
  3.7472916753705187`*^9}]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Kernels of type ",
 Cell[BoxData[
  FormBox[
   FractionBox["1", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["r", "2"], "-", 
      SuperscriptBox["y", "2"]}]]], TraditionalForm]]]
}], "Chapter",
 CellChangeTimes->{{3.7177548018952417`*^9, 3.717754828938238*^9}, {
  3.717754866660471*^9, 3.717754883528428*^9}, {3.717757220620521*^9, 
  3.717757220707312*^9}, {3.720934025449567*^9, 3.720934025589076*^9}}],

Cell["\<\
Singularity treatment of the backward or inverse Abel transform. Same \
reasoning as for the forward Abel transform.\
\>", "Text",
 CellChangeTimes->{{3.7472881087077594`*^9, 3.747288140928117*^9}}],

Cell[CellGroupData[{

Cell["Singular end", "Subchapter",
 CellChangeTimes->{
  3.7177572887176*^9, 3.71775731908568*^9, {3.7184700856826878`*^9, 
   3.7184700858485813`*^9}, 3.720934025625864*^9}],

Cell[CellGroupData[{

Cell["Small y", "Section",
 CellChangeTimes->{{3.718470012066473*^9, 3.718470014126327*^9}, 
   3.720934025732243*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prec", "=", "80"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ordAna", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"err", "=", 
   RowBox[{"10", "^", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "prec"}], "/", "2"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kmax", "=", "19"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nmax", "=", 
   RowBox[{"10", "^", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yIndMax", "=", "128"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"yIndTab", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"ii", ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "0", ",", "yIndMax"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"kInner", "=", 
       RowBox[{"Floor", "[", 
        RowBox[{"k", "/", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"kOuter", "=", 
       RowBox[{"Floor", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k", "-", "1"}], ")"}], "/", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"yInd", "=", 
           RowBox[{"yIndTab", "[", 
            RowBox[{"[", "mm", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"n", "=", 
           RowBox[{"nmax", "+", "yInd"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"h", "=", 
           RowBox[{"R", "/", 
            RowBox[{"(", 
             RowBox[{"n", "-", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"y", "=", 
           RowBox[{"yInd", "*", "h"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"yInd", "\[LessEqual]", "kInner"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"fun", "=", 
              RowBox[{"Simplify", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"(", "r", ")"}], "^", 
                  RowBox[{"(", "ii", ")"}]}], "/", 
                 RowBox[{"Sqrt", "[", 
                  RowBox[{
                   RowBox[{"r", "^", "2"}], "-", 
                   RowBox[{"y", "^", "2"}]}], "]"}]}], ",", 
                RowBox[{"Assumptions", "\[Rule]", 
                 RowBox[{"r", ">=", "0"}]}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"funNoSqrtSing", "=", 
              RowBox[{"Simplify", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"(", "r", ")"}], "^", 
                  RowBox[{"(", "ii", ")"}]}], "/", 
                 RowBox[{"Sqrt", "[", 
                  RowBox[{"r", "+", "y"}], "]"}]}], ",", 
                RowBox[{"Assumptions", "\[Rule]", 
                 RowBox[{"r", ">=", "0"}]}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"funNoSing", "=", 
              RowBox[{
               RowBox[{"(", "r", ")"}], "^", 
               RowBox[{"(", "ii", ")"}]}]}], ";"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"fun", "=", 
              RowBox[{"Simplify", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"r", "-", "y"}], ")"}], "^", 
                  RowBox[{"(", 
                   RowBox[{"ii", "-", "1"}], ")"}]}], "/", 
                 RowBox[{"Sqrt", "[", 
                  RowBox[{
                   RowBox[{"r", "^", "2"}], "-", 
                   RowBox[{"y", "^", "2"}]}], "]"}]}], ",", 
                RowBox[{"Assumptions", "\[Rule]", 
                 RowBox[{"r", ">=", "0"}]}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"funNoSqrtSing", "=", 
              RowBox[{"Simplify", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"r", "-", "y"}], ")"}], "^", 
                  RowBox[{"(", 
                   RowBox[{"ii", "-", "1"}], ")"}]}], "/", 
                 RowBox[{"Sqrt", "[", 
                  RowBox[{"r", "+", "y"}], "]"}]}], ",", 
                RowBox[{"Assumptions", "\[Rule]", 
                 RowBox[{"r", ">=", "0"}]}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"funNoSing", "=", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"r", "-", "y"}], ")"}], "^", 
               RowBox[{"(", 
                RowBox[{"ii", "-", "1"}], ")"}]}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"yInd", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"b", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Total", "[", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{"fun", ",", 
                    RowBox[{"{", 
                    RowBox[{"r", ",", 
                    RowBox[{
                    RowBox[{"2", "*", "ss"}], "-", "1"}]}], "}"}]}], "]"}], 
                    "*", 
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"h", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "ss"}], "-", "1"}], ")"}]}], "*", 
                    RowBox[{
                    RowBox[{"BernoulliB", "[", 
                    RowBox[{"2", "*", "ss"}], "]"}], "/", 
                    RowBox[{"Factorial", "[", 
                    RowBox[{"2", "*", "ss"}], "]"}]}]}], ",", "prec"}], 
                    "]"}]}], "/.", 
                    RowBox[{"r", "\[Rule]", "0"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"ss", ",", "1", ",", "ii"}], "}"}]}], "]"}], ",", 
                   
                   RowBox[{
                   "Method", "\[Rule]", "\"\<CompensatedSummation\>\""}]}], 
                  "]"}], "+", 
                 RowBox[{
                  RowBox[{"1", "/", "2"}], "*", 
                  RowBox[{"(", 
                   RowBox[{"fun", "/.", 
                    RowBox[{"r", "\[Rule]", "0"}]}], ")"}]}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"ii", ",", "1", ",", "k"}], "}"}]}], "]"}]}], ";"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"yInd", "<", "20"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"b", "=", 
              RowBox[{"Table", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"intervals", "=", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"jj", "-", "1"}], ")"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"jj", ",", "1", ",", "nmax"}], "}"}]}], "]"}]}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"arr", "=", 
                  RowBox[{"ConstantArray", "[", 
                   RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{"0", ",", "prec"}], "]"}], ",", 
                    RowBox[{"2", "+", "ordAna"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"arr", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "=", 
                  RowBox[{"NIntegrate", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"fun", "/.", 
                    RowBox[{"r", "\[Rule]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"nInd", "+", "yInd"}], ")"}], "*", "h"}]}]}], 
                    ")"}], "-", 
                    RowBox[{"(", 
                    RowBox[{"fun", "/.", 
                    RowBox[{"r", "\[Rule]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ceiling", "[", "nInd", "]"}], "+", "yInd"}], 
                    ")"}], "*", "h"}]}]}], ")"}]}], ",", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", "nInd", "}"}], ",", "intervals"}], "]"}], 
                    ",", 
                    RowBox[{"PrecisionGoal", "\[Rule]", 
                    RowBox[{"prec", "/", "2"}]}], ",", 
                    RowBox[{"WorkingPrecision", "\[Rule]", "prec"}], ",", 
                    RowBox[{"MaxRecursion", "\[Rule]", "50"}], ",", 
                    RowBox[{"Method", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", 
                    RowBox[{"\"\<SymbolicProcessing\>\"", "\[Rule]", "0"}]}], 
                    "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"arr", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "=", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "2"}], "*", "fun"}], "/.", 
                    RowBox[{"r", "\[Rule]", "R"}]}], ")"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"arr", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "=", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{"fun", ",", 
                    RowBox[{"{", 
                    RowBox[{"r", ",", "1"}], "}"}]}], "]"}], "*", 
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{"h", "*", 
                    RowBox[{
                    RowBox[{"BernoulliB", "[", "2", "]"}], "/", 
                    RowBox[{"Factorial", "[", "2", "]"}]}]}], ",", "prec"}], 
                    "]"}]}], "/.", 
                   RowBox[{"r", "\[Rule]", "R"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"For", "[", 
                  RowBox[{
                   RowBox[{"ll", "=", "2"}], ",", 
                   RowBox[{"ll", "\[LessEqual]", "ordAna"}], ",", 
                   RowBox[{"ll", "++"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", "+", "ll"}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{"fun", ",", 
                    RowBox[{"{", 
                    RowBox[{"r", ",", 
                    RowBox[{
                    RowBox[{"2", "*", "ll"}], "-", "1"}]}], "}"}]}], "]"}], 
                    "*", 
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"h", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "ll"}], "-", "1"}], ")"}]}], "*", 
                    RowBox[{
                    RowBox[{"BernoulliB", "[", 
                    RowBox[{"2", "*", "ll"}], "]"}], "/", 
                    RowBox[{"Factorial", "[", 
                    RowBox[{"2", "*", "ll"}], "]"}]}]}], ",", "prec"}], 
                    "]"}]}], "/.", 
                    RowBox[{"r", "\[Rule]", "R"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"sum", "=", 
                    RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", 
                    RowBox[{"2", "+", "ll"}]}], "]"}], "]"}], ",", 
                    RowBox[{
                    "Method", "\[Rule]", "\"\<CompensatedSummation\>\""}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ll", ">", 
                    RowBox[{"Floor", "[", 
                    RowBox[{"2", "+", 
                    RowBox[{"ii", "/", "2"}]}], "]"}]}], "&&", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", "+", "ll"}], "]"}], "]"}], "]"}], "<=", 
                    RowBox[{"err", "*", 
                    RowBox[{"Abs", "[", "sum", "]"}]}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Break", "[", "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ll", "\[GreaterEqual]", "ordAna"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "yInd", ",", 
                    "\"\<Euler-Mclaurin series possibly not converged.\>\""}],
                     "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                 "sum"}], ",", 
                RowBox[{"{", 
                 RowBox[{"ii", ",", "1", ",", "k"}], "}"}]}], "]"}]}], ";"}], 
            ",", "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"b", "=", 
              RowBox[{"Table", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"arr", "=", 
                  RowBox[{"ConstantArray", "[", 
                   RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{"0", ",", "prec"}], "]"}], ",", 
                    RowBox[{"ordAna", "+", "1"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"arr", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "=", 
                  RowBox[{
                   RowBox[{"funNoSqrtSing", "*", 
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Zeta", "[", 
                    RowBox[{"1", "/", "2"}], "]"}], "*", 
                    RowBox[{"h", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "2"}], ")"}]}]}], ",", "prec"}], 
                    "]"}]}], "/.", 
                   RowBox[{"r", "\[Rule]", "y"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"For", "[", 
                  RowBox[{
                   RowBox[{"ll", "=", "1"}], ",", 
                   RowBox[{"ll", "\[LessEqual]", "ordAna"}], ",", 
                   RowBox[{"ll", "++"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", "+", "ll"}], "]"}], "]"}], "=", 
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{"funNoSqrtSing", ",", 
                    RowBox[{"{", 
                    RowBox[{"r", ",", "ll"}], "}"}]}], "]"}], "*", 
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Zeta", "[", 
                    RowBox[{
                    RowBox[{"1", "/", "2"}], "-", "ll"}], "]"}], "*", 
                    RowBox[{
                    RowBox[{"h", "^", 
                    RowBox[{"(", 
                    RowBox[{"ll", "-", 
                    RowBox[{"1", "/", "2"}]}], ")"}]}], "/", 
                    RowBox[{"Factorial", "[", "ll", "]"}]}]}], ",", "prec"}], 
                    "]"}]}], "/.", 
                    RowBox[{"r", "\[Rule]", "y"}]}], ",", "prec"}], "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"sum", "=", 
                    RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", 
                    RowBox[{"1", "+", "ll"}]}], "]"}], "]"}], ",", 
                    RowBox[{
                    "Method", "\[Rule]", "\"\<CompensatedSummation\>\""}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ll", ">", 
                    RowBox[{"1", "+", "ii"}]}], "&&", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", "+", "ll"}], "]"}], "]"}], "]"}], "<=", 
                    RowBox[{"err", "*", 
                    RowBox[{"Abs", "[", "sum", "]"}]}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Break", "[", "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ll", "\[GreaterEqual]", "ordAna"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "yInd", ",", 
                    "\"\<Euler-Mclaurin series possibly not converged.\>\""}],
                     "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"-", "sum"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"ii", ",", "1", ",", "k"}], "}"}]}], "]"}]}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"A", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"N", "[", 
              RowBox[{
               RowBox[{"funNoSing", "/.", 
                RowBox[{"r", "\[Rule]", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"yInd", "+", "jj"}], ")"}], "*", "h"}]}]}], ",", 
               "prec"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"ii", ",", "1", ",", "k"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"jj", ",", 
               RowBox[{"-", "kOuter"}], ",", "kInner"}], "}"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"k", "\[Equal]", "1"}], " ", "&&", " ", 
             RowBox[{"yInd", "\[Equal]", "0"}]}], ",", "\[IndentingNewLine]", 
            
            RowBox[{"N", "[", 
             RowBox[{"{", "0.", "}"}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"yInd", "\[LessEqual]", "kInner"}], " ", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"N", "[", 
             RowBox[{
              RowBox[{"LeastSquares", "[", 
               RowBox[{
                RowBox[{"A", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ";;", 
                   RowBox[{"k", "-", "1"}]}], "]"}], "]"}], ",", 
                RowBox[{"b", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ";;", 
                   RowBox[{"k", "-", "1"}]}], "]"}], "]"}]}], "]"}], "*", 
              "h"}], "]"}], ",", "\[IndentingNewLine]", "True", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"N", "[", 
             RowBox[{
              RowBox[{"LinearSolve", "[", 
               RowBox[{"A", ",", "b"}], "]"}], "*", "h"}], "]"}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"mm", ",", "1", ",", 
           RowBox[{"Length", "[", "yIndTab", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"Chop", "[", 
        RowBox[{"res", ",", "err"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"N", "[", "res", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"StringJoin", "[", 
         RowBox[{"\"\<coeffs_invSqrtDiffSq_sing_small_\>\"", ",", 
          RowBox[{"IntegerString", "[", 
           RowBox[{"k", ",", "10", ",", "2"}], "]"}], ",", "\"\<.h5\>\""}], 
         "]"}], ",", "res"}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "kmax", ",", "1"}], "}"}]}], "]"}], ";"}], "//",
   "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.7203413559014797`*^9, 3.720341356180271*^9}, {
   3.7203414016752167`*^9, 3.7203414109667788`*^9}, {3.720449021075684*^9, 
   3.7204490212826757`*^9}, {3.72071279165317*^9, 3.720712791820134*^9}, 
   3.7207128478026667`*^9, {3.720712879052259*^9, 3.720712896924591*^9}, 
   3.720713973477992*^9, {3.720766288486055*^9, 3.7207662887920713`*^9}, {
   3.720778905558267*^9, 3.720778906030109*^9}, {3.720934025811854*^9, 
   3.720934025827635*^9}, 3.720952959466075*^9, 3.721022809732502*^9, {
   3.721326244258887*^9, 3.7213262442698936`*^9}, {3.721545813510614*^9, 
   3.721545813521563*^9}, {3.7215498979408913`*^9, 3.721549915053472*^9}, {
   3.721549978365419*^9, 3.7215499817040567`*^9}, {3.72155026472834*^9, 
   3.7215503326592083`*^9}, {3.721550371880539*^9, 3.7215504197155743`*^9}, {
   3.721550582761876*^9, 3.721550609506571*^9}, {3.721550719346682*^9, 
   3.721550819105399*^9}, {3.721550881418819*^9, 3.7215508821293383`*^9}, {
   3.721550932991663*^9, 3.721550941545204*^9}, {3.721551095065524*^9, 
   3.7215511015800867`*^9}, {3.7215512377730837`*^9, 3.721551312404771*^9}, {
   3.7215513740991488`*^9, 3.721551413562236*^9}, 3.721551849867622*^9, {
   3.721551907025448*^9, 3.721551951337247*^9}, {3.7215520475287123`*^9, 
   3.721552050351583*^9}, {3.721552118389284*^9, 3.721552142682169*^9}, 
   3.7215524229802523`*^9, {3.721552484697236*^9, 3.721552485910223*^9}, {
   3.721561874225667*^9, 3.721561895331555*^9}, {3.721562211131263*^9, 
   3.721562214287868*^9}, {3.7465971329487324`*^9, 3.746597151700533*^9}, {
   3.746597223557229*^9, 3.7465972284042606`*^9}, {3.7465998612316923`*^9, 
   3.746599865223055*^9}, 3.74663151941278*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"567.4798220797818`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.720341609074449*^9, 3.7204526012173977`*^9, 3.720713407809924*^9, 
   3.720766769403919*^9, 3.720780660704095*^9, {3.721550321878893*^9, 
   3.7215503381294317`*^9}, {3.7215504069095488`*^9, 3.721550425458007*^9}, 
   3.7215506138945713`*^9, {3.7215507730796337`*^9, 3.721550824747995*^9}, 
   3.721550887599*^9, 3.721550949339973*^9, 3.721551319949428*^9, 
   3.721551422319109*^9, 3.721551863522161*^9, 3.7215519164969387`*^9, 
   3.721551959924796*^9, 3.7215520896211557`*^9, 3.7215523768959093`*^9, 
   3.7215619065057173`*^9, 3.721562220316914*^9, 3.7466024180527782`*^9, 
   3.747292242933988*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prec", "=", "80"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ordAna", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"err", "=", 
   RowBox[{"10", "^", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "prec"}], "/", "2"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kmax", "=", "19"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nmax", "=", 
   RowBox[{"10", "^", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yIndMax", "=", "128"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"yIndTab", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"1", "/", "2"}], "+", "ii"}], ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "0", ",", "yIndMax"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"kInner", "=", 
       RowBox[{"Floor", "[", 
        RowBox[{"k", "/", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"kOuter", "=", 
       RowBox[{"Floor", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k", "-", "1"}], ")"}], "/", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"yInd", "=", 
           RowBox[{"yIndTab", "[", 
            RowBox[{"[", "mm", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"n", "=", 
           RowBox[{"nmax", "+", "yInd"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"h", "=", 
           RowBox[{"R", "/", 
            RowBox[{"(", 
             RowBox[{"n", "-", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"y", "=", 
           RowBox[{"yInd", "*", "h"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"fun", "=", 
           RowBox[{"Simplify", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"r", "-", "y"}], ")"}], "^", 
               RowBox[{"(", 
                RowBox[{"ii", "-", "1"}], ")"}]}], "/", 
              RowBox[{"Sqrt", "[", 
               RowBox[{
                RowBox[{"r", "^", "2"}], "-", 
                RowBox[{"y", "^", "2"}]}], "]"}]}], ",", 
             RowBox[{"Assumptions", "\[Rule]", 
              RowBox[{"r", ">=", "0"}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"funNoSqrtSing", "=", 
           RowBox[{"Simplify", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"r", "-", "y"}], ")"}], "^", 
               RowBox[{"(", 
                RowBox[{"ii", "-", "1"}], ")"}]}], "/", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"r", "+", "y"}], "]"}]}], ",", 
             RowBox[{"Assumptions", "\[Rule]", 
              RowBox[{"r", ">=", "0"}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"funNoSing", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"r", "-", "y"}], ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"ii", "-", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"yInd", "<", "20"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"b", "=", 
              RowBox[{"Table", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"intervals", "=", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"jj", "-", "1"}], ")"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"jj", ",", "1", ",", "nmax"}], "}"}]}], "]"}]}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"arr", "=", 
                  RowBox[{"ConstantArray", "[", 
                   RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{"0", ",", "prec"}], "]"}], ",", 
                    RowBox[{"2", "+", "ordAna"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"arr", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "=", 
                  RowBox[{"NIntegrate", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"fun", "/.", 
                    RowBox[{"r", "\[Rule]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"nInd", "+", "yInd"}], ")"}], "*", "h"}]}]}], 
                    ")"}], "-", 
                    RowBox[{"(", 
                    RowBox[{"fun", "/.", 
                    RowBox[{"r", "\[Rule]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ceiling", "[", "nInd", "]"}], "+", "yInd"}], 
                    ")"}], "*", "h"}]}]}], ")"}]}], ",", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", "nInd", "}"}], ",", "intervals"}], "]"}], 
                    ",", 
                    RowBox[{"PrecisionGoal", "\[Rule]", 
                    RowBox[{"prec", "/", "2"}]}], ",", 
                    RowBox[{"WorkingPrecision", "\[Rule]", "prec"}], ",", 
                    RowBox[{"MaxRecursion", "\[Rule]", "50"}], ",", 
                    RowBox[{"Method", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", 
                    RowBox[{"\"\<SymbolicProcessing\>\"", "\[Rule]", "0"}]}], 
                    "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"arr", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "=", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "2"}], "*", "fun"}], "/.", 
                    RowBox[{"r", "\[Rule]", "R"}]}], ")"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"arr", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "=", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{"fun", ",", 
                    RowBox[{"{", 
                    RowBox[{"r", ",", "1"}], "}"}]}], "]"}], "*", 
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{"h", "*", 
                    RowBox[{
                    RowBox[{"BernoulliB", "[", "2", "]"}], "/", 
                    RowBox[{"Factorial", "[", "2", "]"}]}]}], ",", "prec"}], 
                    "]"}]}], "/.", 
                   RowBox[{"r", "\[Rule]", "R"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"For", "[", 
                  RowBox[{
                   RowBox[{"ll", "=", "2"}], ",", 
                   RowBox[{"ll", "\[LessEqual]", "ordAna"}], ",", 
                   RowBox[{"ll", "++"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", "+", "ll"}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{"fun", ",", 
                    RowBox[{"{", 
                    RowBox[{"r", ",", 
                    RowBox[{
                    RowBox[{"2", "*", "ll"}], "-", "1"}]}], "}"}]}], "]"}], 
                    "*", 
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"h", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "ll"}], "-", "1"}], ")"}]}], "*", 
                    RowBox[{
                    RowBox[{"BernoulliB", "[", 
                    RowBox[{"2", "*", "ll"}], "]"}], "/", 
                    RowBox[{"Factorial", "[", 
                    RowBox[{"2", "*", "ll"}], "]"}]}]}], ",", "prec"}], 
                    "]"}]}], "/.", 
                    RowBox[{"r", "\[Rule]", "R"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"sum", "=", 
                    RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", 
                    RowBox[{"2", "+", "ll"}]}], "]"}], "]"}], ",", 
                    RowBox[{
                    "Method", "\[Rule]", "\"\<CompensatedSummation\>\""}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ll", ">", 
                    RowBox[{"Floor", "[", 
                    RowBox[{"2", "+", 
                    RowBox[{"ii", "/", "2"}]}], "]"}]}], "&&", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", "+", "ll"}], "]"}], "]"}], "]"}], "<=", 
                    RowBox[{"err", "*", 
                    RowBox[{"Abs", "[", "sum", "]"}]}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Break", "[", "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ll", "\[GreaterEqual]", "ordAna"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "yInd", ",", 
                    "\"\<Euler-Mclaurin series possibly not converged.\>\""}],
                     "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                 "sum"}], ",", 
                RowBox[{"{", 
                 RowBox[{"ii", ",", "1", ",", "k"}], "}"}]}], "]"}]}], ";"}], 
            ",", "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"b", "=", 
              RowBox[{"Table", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"arr", "=", 
                  RowBox[{"ConstantArray", "[", 
                   RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{"0", ",", "prec"}], "]"}], ",", 
                    RowBox[{"ordAna", "+", "1"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"arr", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "=", 
                  RowBox[{
                   RowBox[{"funNoSqrtSing", "*", 
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Zeta", "[", 
                    RowBox[{"1", "/", "2"}], "]"}], "*", 
                    RowBox[{"h", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "2"}], ")"}]}]}], ",", "prec"}], 
                    "]"}]}], "/.", 
                   RowBox[{"r", "\[Rule]", "y"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"For", "[", 
                  RowBox[{
                   RowBox[{"ll", "=", "1"}], ",", 
                   RowBox[{"ll", "\[LessEqual]", "ordAna"}], ",", 
                   RowBox[{"ll", "++"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", "+", "ll"}], "]"}], "]"}], "=", 
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{"funNoSqrtSing", ",", 
                    RowBox[{"{", 
                    RowBox[{"r", ",", "ll"}], "}"}]}], "]"}], "*", 
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Zeta", "[", 
                    RowBox[{
                    RowBox[{"1", "/", "2"}], "-", "ll"}], "]"}], "*", 
                    RowBox[{
                    RowBox[{"h", "^", 
                    RowBox[{"(", 
                    RowBox[{"ll", "-", 
                    RowBox[{"1", "/", "2"}]}], ")"}]}], "/", 
                    RowBox[{"Factorial", "[", "ll", "]"}]}]}], ",", "prec"}], 
                    "]"}]}], "/.", 
                    RowBox[{"r", "\[Rule]", "y"}]}], ",", "prec"}], "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"sum", "=", 
                    RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", 
                    RowBox[{"1", "+", "ll"}]}], "]"}], "]"}], ",", 
                    RowBox[{
                    "Method", "\[Rule]", "\"\<CompensatedSummation\>\""}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ll", ">", 
                    RowBox[{"1", "+", "ii"}]}], "&&", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", "+", "ll"}], "]"}], "]"}], "]"}], "<=", 
                    RowBox[{"err", "*", 
                    RowBox[{"Abs", "[", "sum", "]"}]}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Break", "[", "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ll", "\[GreaterEqual]", "ordAna"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "yInd", ",", 
                    "\"\<Euler-Mclaurin series possibly not converged.\>\""}],
                     "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"-", "sum"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"ii", ",", "1", ",", "k"}], "}"}]}], "]"}]}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"A", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"N", "[", 
              RowBox[{
               RowBox[{"funNoSing", "/.", 
                RowBox[{"r", "\[Rule]", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"yInd", "+", "jj"}], ")"}], "*", "h"}]}]}], ",", 
               "prec"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"ii", ",", "1", ",", "k"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"jj", ",", 
               RowBox[{"-", "kOuter"}], ",", "kInner"}], "}"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{"LinearSolve", "[", 
             RowBox[{"A", ",", "b"}], "]"}], "*", "h"}], "]"}]}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"mm", ",", "1", ",", 
           RowBox[{"Length", "[", "yIndTab", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"Chop", "[", 
        RowBox[{"res", ",", "err"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"StringJoin", "[", 
         RowBox[{"\"\<coeffs_invSqrtDiffSq_sing_small_halfShift_\>\"", ",", 
          RowBox[{"IntegerString", "[", 
           RowBox[{"k", ",", "10", ",", "2"}], "]"}], ",", "\"\<.h5\>\""}], 
         "]"}], ",", "res"}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "kmax", ",", "1"}], "}"}]}], "]"}], ";"}], "//",
   "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.720264596039919*^9, 3.720264641400457*^9}, {
   3.720341462724824*^9, 3.720341498476478*^9}, {3.720449027780313*^9, 
   3.720449027961381*^9}, {3.720712920790451*^9, 3.72071293654319*^9}, {
   3.720713179771106*^9, 3.720713187264194*^9}, 3.720713968625845*^9, {
   3.720766311026299*^9, 3.72076631134133*^9}, {3.720778835068391*^9, 
   3.72077883528419*^9}, {3.720934025844741*^9, 3.72093402586059*^9}, 
   3.7209529527548923`*^9, 3.7210228097428503`*^9, {3.7213262442789*^9, 
   3.7213262442899075`*^9}, {3.721545813643314*^9, 3.721545813659343*^9}, {
   3.7215525134781303`*^9, 3.7215525765057487`*^9}, {3.721552610061129*^9, 
   3.721552619408621*^9}, {3.746597243020365*^9, 3.7465972523156104`*^9}, {
   3.7465998776942854`*^9, 3.746599881607425*^9}, {3.7466028757478385`*^9, 
   3.746602888738434*^9}, 3.7466315194430294`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"735.0768113892613`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.720341792729974*^9, 3.720453688405151*^9, 
  3.720714167618886*^9, 3.7207672354257402`*^9, 3.720778846565193*^9, 
  3.720779000179368*^9, 3.720779994238091*^9, 3.721552881335416*^9, 
  3.746602863197279*^9, 3.746603647878724*^9, 3.7472929780833397`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Large ",
 StyleBox["y", "Section"]
}], "Section",
 CellChangeTimes->{{3.717757303877178*^9, 3.717757317430648*^9}, 
   3.718470148374695*^9, 3.720934025880818*^9}],

Cell["Typical evaluation time: Minutes", "Text",
 CellChangeTimes->{{3.7186958253185673`*^9, 3.7186958323994417`*^9}, {
  3.720934025991849*^9, 3.720934026124598*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"prec", "=", "80"}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"R", " ", "=", " ", "1"}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"nmax", " ", "=", " ", 
    RowBox[{"10", "^", "2"}]}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ordAna", " ", "=", " ", "100"}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"err", " ", "=", " ", 
    RowBox[{"10", "^", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "prec"}], "/", "2"}], ")"}]}]}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"kmax", " ", "=", " ", "19"}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"yCross", " ", "=", " ", "128"}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"yInvCount", " ", "=", " ", "256"}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"yInvTable", " ", "=", " ", 
    RowBox[{
     RowBox[{"Range", "[", "yInvCount", "]"}], "/", 
     RowBox[{"(", 
      RowBox[{"yInvCount", "*", "yCross"}], ")"}]}]}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"yIndTab", " ", "=", " ", 
    RowBox[{"1", "/", "yInvTable"}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"kInner", "=", 
       RowBox[{"Floor", "[", 
        RowBox[{"k", "/", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"kOuter", "=", 
       RowBox[{"Floor", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k", "-", "1"}], ")"}], "/", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fun", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x", "-", "1"}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"ii", "-", "1"}], ")"}]}], "/", 
        RowBox[{"Sqrt", "[", "x", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"funNoSing", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x", "-", "1"}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"ii", "-", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"10", "^", "3"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xmax", "=", 
       RowBox[{"N", "[", 
        RowBox[{"1", ",", "prec"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"h", "=", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"n", "-", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"b0", "=", 
       RowBox[{"-", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"funNoSing", ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "ss"}], "}"}]}], "]"}], "*", 
              RowBox[{"N", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Zeta", "[", 
                  RowBox[{
                   RowBox[{"1", "/", "2"}], "-", "ss"}], "]"}], "*", 
                 RowBox[{
                  RowBox[{"h", "^", 
                   RowBox[{"(", 
                    RowBox[{"ss", "-", 
                    RowBox[{"1", "/", "2"}]}], ")"}]}], "/", 
                  RowBox[{"Factorial", "[", "ss", "]"}]}]}], ",", "prec"}], 
               "]"}]}], "/.", 
             RowBox[{"x", "\[Rule]", "0"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"ss", ",", "0", ",", 
              RowBox[{"ii", "-", "1"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", "k"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"A0", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"N", "[", 
          RowBox[{
           RowBox[{"funNoSing", "/.", 
            RowBox[{"x", "\[Rule]", 
             RowBox[{"jj", "*", "h"}]}]}], ",", "prec"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "k"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", 
           RowBox[{"-", "kOuter"}], ",", "kInner"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"A0", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", ";;"}], "]"}], "]"}], "=", 
       RowBox[{"N", "[", 
        RowBox[{"1", ",", "prec"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"resSqrt", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"LinearSolve", "[", 
          RowBox[{"A0", ",", "b0"}], "]"}], "*", 
         RowBox[{"h", "^", 
          RowBox[{"(", 
           RowBox[{"1", "/", "2"}], ")"}]}]}], "//", "N"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"res", " ", "=", " ", 
       RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"yInd", " ", "=", " ", 
           RowBox[{"yIndTab", "[", 
            RowBox[{"[", "mm", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"n", " ", "=", " ", 
           RowBox[{"nmax", " ", "+", " ", "yInd"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"h", " ", "=", " ", 
           RowBox[{"R", "/", 
            RowBox[{"(", 
             RowBox[{"n", " ", "-", " ", "1"}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"y", " ", "=", " ", 
           RowBox[{"yInd", "*", "h"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"fun", " ", "=", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"r", " ", "-", " ", "y"}], ")"}], "^", 
              RowBox[{"(", 
               RowBox[{"ii", " ", "-", " ", "1"}], ")"}]}], ")"}], "/", 
            RowBox[{"Sqrt", "[", 
             RowBox[{
              RowBox[{"r", "^", "2"}], " ", "-", " ", 
              RowBox[{"y", "^", "2"}]}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"funNoSqrtSing", " ", "=", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"r", " ", "-", " ", "y"}], ")"}], "^", 
              RowBox[{"(", 
               RowBox[{"ii", " ", "-", " ", "1"}], ")"}]}], ")"}], "/", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"r", " ", "+", " ", "y"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"funNoSing", " ", "=", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"r", " ", "-", " ", "y"}], ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"ii", " ", "-", " ", "1"}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"b", "=", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"arr", "=", 
               RowBox[{"ConstantArray", "[", 
                RowBox[{
                 RowBox[{"N", "[", 
                  RowBox[{"0", ",", "prec"}], "]"}], ",", 
                 RowBox[{"ordAna", "+", "1"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"arr", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{"funNoSqrtSing", "*", 
                 RowBox[{"N", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Zeta", "[", 
                    RowBox[{"1", "/", "2"}], "]"}], "*", 
                    RowBox[{"h", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "2"}], ")"}]}]}], ",", "prec"}], 
                  "]"}]}], "/.", 
                RowBox[{"r", "\[Rule]", "y"}]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"ll", "=", "1"}], ",", 
                RowBox[{"ll", "\[LessEqual]", "ordAna"}], ",", 
                RowBox[{"ll", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"arr", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", "+", "ll"}], "]"}], "]"}], "=", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{"funNoSqrtSing", ",", 
                    RowBox[{"{", 
                    RowBox[{"r", ",", "ll"}], "}"}]}], "]"}], "*", 
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Zeta", "[", 
                    RowBox[{
                    RowBox[{"1", "/", "2"}], "-", "ll"}], "]"}], "*", 
                    RowBox[{
                    RowBox[{"h", "^", 
                    RowBox[{"(", 
                    RowBox[{"ll", "-", 
                    RowBox[{"1", "/", "2"}]}], ")"}]}], "/", 
                    RowBox[{"Factorial", "[", "ll", "]"}]}]}], ",", "prec"}], 
                    "]"}]}], "/.", 
                   RowBox[{"r", "\[Rule]", "y"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"sum", "=", 
                  RowBox[{"Total", "[", 
                   RowBox[{
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", 
                    RowBox[{"1", "+", "ll"}]}], "]"}], "]"}], ",", 
                    RowBox[{
                    "Method", "\[Rule]", "\"\<CompensatedSummation\>\""}]}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"ll", ">", 
                    RowBox[{"1", "+", "ii"}]}], "&&", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", "+", "ll"}], "]"}], "]"}], "]"}], "<=", 
                    RowBox[{"err", "*", 
                    RowBox[{"Abs", "[", "sum", "]"}]}]}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Break", "[", "]"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ll", "\[GreaterEqual]", "ordAna"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "Print", "[", 
                    "\"\<Euler-Mclaurin series possibly not converged.\>\"", 
                    "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"-", "sum"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"ii", ",", "1", ",", "k"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"A", " ", "=", " ", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"funNoSing", " ", "/.", " ", 
              RowBox[{"r", " ", "\[Rule]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"yInd", "+", " ", "jj"}], ")"}], "*", "h"}]}]}], ",",
              " ", 
             RowBox[{"{", 
              RowBox[{"ii", ",", " ", "1", ",", " ", "k"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"jj", ",", " ", 
               RowBox[{"-", " ", "kOuter"}], " ", ",", "kInner"}], " ", 
              "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{"LinearSolve", "[", 
             RowBox[{"A", ",", " ", "b"}], "]"}], "*", "h", "*", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"2", "*", "yInd"}], "]"}]}], "]"}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"mm", ",", " ", "1", ",", " ", 
           RowBox[{"Length", "[", "yIndTab", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "resSqrt", "}"}], ",", "res"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"StringJoin", "[", 
         RowBox[{"\"\<coeffs_invSqrtDiffSq_sing_large_\>\"", ",", " ", 
          RowBox[{"IntegerString", "[", 
           RowBox[{"k", ",", " ", "10", ",", " ", "2"}], "]"}], ",", " ", 
          "\"\<.h5\>\""}], "]"}], ",", " ", "res"}], "]"}]}], 
     "\[IndentingNewLine]", ",", " ", 
     RowBox[{"{", 
      RowBox[{"k", ",", " ", "1", ",", "kmax", ",", " ", "1"}], "}"}]}], 
    "]"}], ";"}], " ", "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.721548704390819*^9, 3.721548705523057*^9}, {
   3.7215487365716333`*^9, 3.721548758316566*^9}, {3.721548843484561*^9, 
   3.721548847573731*^9}, {3.7465972567087183`*^9, 3.746597265084529*^9}, {
   3.7465973150200405`*^9, 3.746597328387442*^9}, {3.7465998909023275`*^9, 
   3.746599904269633*^9}, 3.746631519467414*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"118.74052504844778`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.721548797855873*^9, 3.721548887757689*^9, 
  3.746603764204209*^9, 3.7472930969419518`*^9}]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Kernel of type ",
 Cell[BoxData[
  FormBox[
   FractionBox[
    RowBox[{
     SuperscriptBox["y", "2"], "/", 
     SuperscriptBox["r", "2"]}], 
    SqrtBox[
     RowBox[{
      SuperscriptBox["r", "2"], "-", 
      SuperscriptBox["y", "2"]}]]], TraditionalForm]]]
}], "Chapter",
 CellChangeTimes->{{3.721021663776155*^9, 3.721021673992641*^9}, {
  3.721991465654776*^9, 3.721991467155756*^9}, {3.746534069043803*^9, 
  3.7465340895156884`*^9}}],

Cell["\<\
Singularity treatment of the modified Abel transform. This isn\
\[CloseCurlyQuote]t really a transform defined in literature, but it pops up \
when calculating Abel transforms of radial vector quantities. Same reasoning \
as for the forward Abel transform for the splitting of small and large y. \
\>", "Text",
 CellChangeTimes->{{3.747288149294471*^9, 3.7472882353809495`*^9}}],

Cell[CellGroupData[{

Cell["Singular end", "Subchapter",
 CellChangeTimes->{{3.721021695490172*^9, 3.72102169797974*^9}}],

Cell[CellGroupData[{

Cell["Small y", "Section",
 CellChangeTimes->{{3.721021735060232*^9, 3.7210217352180023`*^9}, {
  3.7210300579501247`*^9, 3.721030059036936*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prec", "=", "80"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ordAna", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"err", "=", 
   RowBox[{"10", "^", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "prec"}], "/", "2"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kmax", "=", "19"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nmax", "=", 
   RowBox[{"10", "^", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yIndMax", "=", "128"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"yIndTab", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"ii", ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "0", ",", "yIndMax"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"kInner", "=", 
       RowBox[{"Floor", "[", 
        RowBox[{"k", "/", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"kOuter", "=", 
       RowBox[{"Floor", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k", "-", "1"}], ")"}], "/", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"yInd", "=", 
           RowBox[{"yIndTab", "[", 
            RowBox[{"[", "mm", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"n", "=", 
           RowBox[{"nmax", "+", "yInd"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"h", "=", 
           RowBox[{"R", "/", 
            RowBox[{"(", 
             RowBox[{"n", "-", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"y", "=", 
           RowBox[{"yInd", "*", "h"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"fun", "=", 
           RowBox[{"Simplify", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"r", "-", "y"}], ")"}], "^", 
               RowBox[{"(", 
                RowBox[{"ii", "-", "1"}], ")"}]}], "*", 
              RowBox[{
               RowBox[{
                RowBox[{"y", "^", "2"}], "/", 
                RowBox[{"r", "^", "2"}]}], "/", 
               RowBox[{"Sqrt", "[", 
                RowBox[{
                 RowBox[{"r", "^", "2"}], "-", 
                 RowBox[{"y", "^", "2"}]}], "]"}]}]}], ",", 
             RowBox[{"Assumptions", "\[Rule]", 
              RowBox[{"r", ">=", "0"}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"funNoSqrtSing", "=", 
           RowBox[{"Simplify", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"r", "-", "y"}], ")"}], "^", 
               RowBox[{"(", 
                RowBox[{"ii", "-", "1"}], ")"}]}], "*", 
              RowBox[{
               RowBox[{
                RowBox[{"y", "^", "2"}], "/", 
                RowBox[{"r", "^", "2"}]}], "/", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"r", "+", "y"}], "]"}]}]}], ",", 
             RowBox[{"Assumptions", "\[Rule]", 
              RowBox[{"r", ">=", "0"}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"funNoSing", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"r", "-", "y"}], ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"ii", "-", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"yInd", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"b", "=", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{
                RowBox[{"N", "[", 
                 RowBox[{"0", ",", "prec"}], "]"}], ",", "k"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"b", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "=", 
              RowBox[{"N", "[", 
               RowBox[{
                RowBox[{"1", "/", "h"}], ",", "prec"}], "]"}]}], ";"}], 
            "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{"yInd", "<", "40"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"b", "=", 
              RowBox[{"Table", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"intervals", "=", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"jj", "-", "1"}], ")"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"jj", ",", "1", ",", "nmax"}], "}"}]}], "]"}]}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"arr", "=", 
                  RowBox[{"ConstantArray", "[", 
                   RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{"0", ",", "prec"}], "]"}], ",", 
                    RowBox[{"2", "+", "ordAna"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"arr", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "=", 
                  RowBox[{"NIntegrate", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"fun", "/.", 
                    RowBox[{"r", "\[Rule]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"nInd", "+", "yInd"}], ")"}], "*", "h"}]}]}], 
                    ")"}], "-", 
                    RowBox[{"(", 
                    RowBox[{"fun", "/.", 
                    RowBox[{"r", "\[Rule]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ceiling", "[", "nInd", "]"}], "+", "yInd"}], 
                    ")"}], "*", "h"}]}]}], ")"}]}], ",", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", "nInd", "}"}], ",", "intervals"}], "]"}], 
                    ",", 
                    RowBox[{"PrecisionGoal", "\[Rule]", 
                    RowBox[{"prec", "/", "2"}]}], ",", 
                    RowBox[{"WorkingPrecision", "\[Rule]", "prec"}], ",", 
                    RowBox[{"MaxRecursion", "\[Rule]", "50"}], ",", 
                    RowBox[{"Method", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", 
                    RowBox[{"\"\<SymbolicProcessing\>\"", "\[Rule]", "0"}]}], 
                    "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"arr", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "=", 
                  RowBox[{"N", "[", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "2"}], "*", "fun"}], "/.", 
                    RowBox[{"r", "\[Rule]", "R"}]}], ")"}], ",", "prec"}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"arr", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "=", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{"fun", ",", 
                    RowBox[{"{", 
                    RowBox[{"r", ",", "1"}], "}"}]}], "]"}], "*", 
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{"h", "*", 
                    RowBox[{
                    RowBox[{"BernoulliB", "[", "2", "]"}], "/", 
                    RowBox[{"Factorial", "[", "2", "]"}]}]}], ",", "prec"}], 
                    "]"}]}], "/.", 
                   RowBox[{"r", "\[Rule]", "R"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"For", "[", 
                  RowBox[{
                   RowBox[{"ll", "=", "2"}], ",", 
                   RowBox[{"ll", "\[LessEqual]", "ordAna"}], ",", 
                   RowBox[{"ll", "++"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", "+", "ll"}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{"fun", ",", 
                    RowBox[{"{", 
                    RowBox[{"r", ",", 
                    RowBox[{
                    RowBox[{"2", "*", "ll"}], "-", "1"}]}], "}"}]}], "]"}], 
                    "*", 
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"h", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "ll"}], "-", "1"}], ")"}]}], "*", 
                    RowBox[{
                    RowBox[{"BernoulliB", "[", 
                    RowBox[{"2", "*", "ll"}], "]"}], "/", 
                    RowBox[{"Factorial", "[", 
                    RowBox[{"2", "*", "ll"}], "]"}]}]}], ",", "prec"}], 
                    "]"}]}], "/.", 
                    RowBox[{"r", "\[Rule]", "R"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"sum", "=", 
                    RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", 
                    RowBox[{"2", "+", "ll"}]}], "]"}], "]"}], ",", 
                    RowBox[{
                    "Method", "\[Rule]", "\"\<CompensatedSummation\>\""}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ll", ">", 
                    RowBox[{"Floor", "[", 
                    RowBox[{"2", "+", 
                    RowBox[{"ii", "/", "2"}]}], "]"}]}], "&&", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", "+", "ll"}], "]"}], "]"}], "]"}], "<=", 
                    RowBox[{"err", "*", 
                    RowBox[{"Abs", "[", "sum", "]"}]}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Break", "[", "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ll", "\[GreaterEqual]", "ordAna"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "yInd", ",", 
                    "\"\<Euler-Mclaurin series possibly not converged.\>\""}],
                     "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                 "sum"}], ",", 
                RowBox[{"{", 
                 RowBox[{"ii", ",", "1", ",", "k"}], "}"}]}], "]"}]}], ";"}], 
            ",", "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"b", "=", 
              RowBox[{"Table", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"arr", "=", 
                  RowBox[{"ConstantArray", "[", 
                   RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{"0", ",", "prec"}], "]"}], ",", 
                    RowBox[{"ordAna", "+", "1"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"arr", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "=", 
                  RowBox[{
                   RowBox[{"funNoSqrtSing", "*", 
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Zeta", "[", 
                    RowBox[{"1", "/", "2"}], "]"}], "*", 
                    RowBox[{"h", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "2"}], ")"}]}]}], ",", "prec"}], 
                    "]"}]}], "/.", 
                   RowBox[{"r", "\[Rule]", "y"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"For", "[", 
                  RowBox[{
                   RowBox[{"ll", "=", "1"}], ",", 
                   RowBox[{"ll", "\[LessEqual]", "ordAna"}], ",", 
                   RowBox[{"ll", "++"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", "+", "ll"}], "]"}], "]"}], "=", 
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{"funNoSqrtSing", ",", 
                    RowBox[{"{", 
                    RowBox[{"r", ",", "ll"}], "}"}]}], "]"}], "*", 
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Zeta", "[", 
                    RowBox[{
                    RowBox[{"1", "/", "2"}], "-", "ll"}], "]"}], "*", 
                    RowBox[{
                    RowBox[{"h", "^", 
                    RowBox[{"(", 
                    RowBox[{"ll", "-", 
                    RowBox[{"1", "/", "2"}]}], ")"}]}], "/", 
                    RowBox[{"Factorial", "[", "ll", "]"}]}]}], ",", "prec"}], 
                    "]"}]}], "/.", 
                    RowBox[{"r", "\[Rule]", "y"}]}], ",", "prec"}], "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"sum", "=", 
                    RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", 
                    RowBox[{"1", "+", "ll"}]}], "]"}], "]"}], ",", 
                    RowBox[{
                    "Method", "\[Rule]", "\"\<CompensatedSummation\>\""}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ll", ">", 
                    RowBox[{"1", "+", "ii"}]}], "&&", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", "+", "ll"}], "]"}], "]"}], "]"}], "<=", 
                    RowBox[{"err", "*", 
                    RowBox[{"Abs", "[", "sum", "]"}]}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Break", "[", "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ll", "\[GreaterEqual]", "ordAna"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "yInd", ",", 
                    "\"\<Euler-Mclaurin series possibly not converged.\>\""}],
                     "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"-", "sum"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"ii", ",", "1", ",", "k"}], "}"}]}], "]"}]}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"A", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"funNoSing", "/.", 
              RowBox[{"r", "\[Rule]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"yInd", "+", "jj"}], ")"}], "*", "h"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"ii", ",", "1", ",", "k"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"jj", ",", 
               RowBox[{"-", "kOuter"}], ",", "kInner"}], "}"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{"LinearSolve", "[", 
             RowBox[{"A", ",", "b"}], "]"}], "*", "h"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"mm", ",", "1", ",", 
           RowBox[{"Length", "[", "yIndTab", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"StringJoin", "[", 
         RowBox[{"\"\<coeffs_invSqrtDiffSqY2OR2_sing_small_\>\"", ",", 
          RowBox[{"IntegerString", "[", 
           RowBox[{"k", ",", "10", ",", "2"}], "]"}], ",", "\"\<.h5\>\""}], 
         "]"}], ",", "res"}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "kmax", ",", "1"}], "}"}]}], "]"}], ";"}], "//",
   "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.718471989890789*^9, 3.7184719979731436`*^9}, {
   3.718472138835555*^9, 3.7184721525256343`*^9}, {3.718472460018538*^9, 
   3.718472470219298*^9}, {3.7184727521812763`*^9, 3.718472752706625*^9}, {
   3.7184732080965996`*^9, 3.7184732450060763`*^9}, {3.7184735419529824`*^9, 
   3.718473542035041*^9}, {3.718642391647255*^9, 3.718642391895194*^9}, {
   3.7186425126144867`*^9, 3.718642539939292*^9}, {3.718643086751134*^9, 
   3.7186430900506687`*^9}, {3.718645422512672*^9, 3.7186454227990227`*^9}, 
   3.718696938521366*^9, {3.718961845359117*^9, 3.718961845592506*^9}, {
   3.7202644249826097`*^9, 3.720264427042261*^9}, {3.720266935102071*^9, 
   3.720267090087277*^9}, {3.720267128436555*^9, 3.720267137617923*^9}, {
   3.720267171242806*^9, 3.720267211433264*^9}, {3.7202690715269537`*^9, 
   3.720269078702075*^9}, {3.7202707732535267`*^9, 3.7202708616827183`*^9}, {
   3.7202709002074623`*^9, 3.720270963099832*^9}, {3.720271107812818*^9, 
   3.720271109931691*^9}, {3.7202719412726593`*^9, 3.720272045447665*^9}, {
   3.720272102999*^9, 3.720272106306027*^9}, {3.720272177126067*^9, 
   3.7202722574161158`*^9}, {3.7202723483318167`*^9, 3.7202723879731407`*^9}, 
   3.720272498397957*^9, {3.720272563777452*^9, 3.720272581672607*^9}, {
   3.720272662565556*^9, 3.7202726637846127`*^9}, {3.720272714239217*^9, 
   3.720272714379681*^9}, {3.720285278801832*^9, 3.720285285617342*^9}, {
   3.720448955745727*^9, 3.7204489569900217`*^9}, {3.720606672887506*^9, 
   3.720606681241007*^9}, {3.720607821968292*^9, 3.720607842864077*^9}, {
   3.720616660330385*^9, 3.720616662880501*^9}, {3.720616861879002*^9, 
   3.720616862067862*^9}, {3.7206169339536247`*^9, 3.720616947628991*^9}, {
   3.720617017165596*^9, 3.720617077711866*^9}, {3.720617115801054*^9, 
   3.720617127674078*^9}, {3.720621667704871*^9, 3.720621708264797*^9}, {
   3.720621749910529*^9, 3.720621750080724*^9}, {3.720625487208968*^9, 
   3.7206255044029713`*^9}, {3.720625648035873*^9, 3.7206256567555447`*^9}, {
   3.720626813830098*^9, 3.7206268139788437`*^9}, {3.720627992783229*^9, 
   3.7206279941882143`*^9}, {3.720629042161683*^9, 3.7206290649392567`*^9}, {
   3.72062913921812*^9, 3.720629139722768*^9}, {3.720629408473379*^9, 
   3.720629442138999*^9}, {3.720629601671196*^9, 3.720629602454349*^9}, {
   3.720635396056142*^9, 3.720635425472004*^9}, {3.720635528456625*^9, 
   3.7206355296425*^9}, {3.720637470498969*^9, 3.720637496023485*^9}, {
   3.720637581938581*^9, 3.720637589162951*^9}, {3.720637717950459*^9, 
   3.720637718500958*^9}, {3.720638173539885*^9, 3.720638174258007*^9}, {
   3.720682659848254*^9, 3.720682673541843*^9}, {3.7206828731338778`*^9, 
   3.720682921446822*^9}, {3.720682967995179*^9, 3.720682979003544*^9}, {
   3.720683095724469*^9, 3.720683164596075*^9}, {3.7206832266494093`*^9, 
   3.7206833060615797`*^9}, {3.7206833694796057`*^9, 3.720683389755145*^9}, {
   3.720683438246131*^9, 3.720683479049657*^9}, {3.720683519841331*^9, 
   3.7206835234433327`*^9}, {3.720683582682539*^9, 3.720683594130582*^9}, {
   3.72068368728664*^9, 3.720683687541478*^9}, {3.7206837264542027`*^9, 
   3.720683737118294*^9}, {3.720683778462471*^9, 3.720683795926656*^9}, {
   3.720683848482685*^9, 3.720683902154455*^9}, {3.720683932227162*^9, 
   3.7206840027183437`*^9}, {3.720684039210885*^9, 3.7206840508269043`*^9}, {
   3.720684081678876*^9, 3.72068409823076*^9}, {3.720684136805415*^9, 
   3.720684138039647*^9}, {3.7206842421179333`*^9, 3.720684243380007*^9}, {
   3.7207062893946333`*^9, 3.7207063837086077`*^9}, {3.720706415902021*^9, 
   3.720706424312744*^9}, {3.720706466807208*^9, 3.7207065147925997`*^9}, {
   3.720706699338016*^9, 3.720706707676508*^9}, 3.7207139844379997`*^9, {
   3.7207793605796833`*^9, 3.720779360858508*^9}, {3.7209340243439913`*^9, 
   3.720934024361314*^9}, {3.720953015513442*^9, 3.720953017817992*^9}, 
   3.7209541636106787`*^9, 3.7210217615012093`*^9, {3.7210217937259197`*^9, 
   3.721021843281674*^9}, {3.7210219207943563`*^9, 3.7210219384155073`*^9}, 
   3.7210219823367443`*^9, {3.7210220158979073`*^9, 3.721022018341487*^9}, {
   3.721022117402586*^9, 3.721022148045536*^9}, {3.721022325262353*^9, 
   3.721022370031712*^9}, {3.721022496680875*^9, 3.721022566798365*^9}, {
   3.721022632661578*^9, 3.721022651484763*^9}, {3.7210227085087337`*^9, 
   3.7210227099753304`*^9}, {3.721022781121714*^9, 3.7210227828321238`*^9}, {
   3.721023314919675*^9, 3.721023318801105*^9}, 3.7210233508889923`*^9, {
   3.721023508554517*^9, 3.7210235087165194`*^9}, {3.7210240153890467`*^9, 
   3.721024032488956*^9}, {3.721024073692507*^9, 3.7210241355438633`*^9}, {
   3.721025118033238*^9, 3.721025135373353*^9}, {3.7210251685446653`*^9, 
   3.721025237530081*^9}, 3.721025295034494*^9, {3.721025534646294*^9, 
   3.721025608181848*^9}, {3.721025658643076*^9, 3.721025679989565*^9}, {
   3.721025734120912*^9, 3.721025773905437*^9}, {3.721025819937233*^9, 
   3.72102586064992*^9}, {3.721025911756048*^9, 3.72102591523007*^9}, {
   3.721025977153161*^9, 3.721026072993928*^9}, {3.721026157151535*^9, 
   3.7210263321428833`*^9}, {3.721026450419592*^9, 3.721026486814084*^9}, {
   3.7210268250748367`*^9, 3.721026825724017*^9}, {3.721026887124003*^9, 
   3.721026887575067*^9}, {3.721027100342765*^9, 3.7210271368068657`*^9}, {
   3.7210272492875357`*^9, 3.721027250128645*^9}, {3.721027282417183*^9, 
   3.721027349676564*^9}, {3.721030905379027*^9, 3.721030906893841*^9}, {
   3.7218488771239977`*^9, 3.7218488776702127`*^9}, {3.721848996101645*^9, 
   3.721849070713517*^9}, {3.721849190138898*^9, 3.721849193710367*^9}, {
   3.721849273748794*^9, 3.721849277537383*^9}, {3.721849967770603*^9, 
   3.721849997810011*^9}, {3.721850243142131*^9, 3.721850244391808*^9}, {
   3.721852763714488*^9, 3.7218527694569473`*^9}, {3.7219033035140676`*^9, 
   3.7219033041209183`*^9}, {3.7219040547564077`*^9, 3.72190407933261*^9}, {
   3.721991178587269*^9, 3.721991216910447*^9}, {3.721991377334652*^9, 
   3.721991378367278*^9}, {3.7465973362002726`*^9, 3.746597345692445*^9}, 
   3.7465975523241158`*^9, {3.7465976738594403`*^9, 3.746597678475738*^9}, 
   3.746631519496684*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2522.268087858422`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.720272657763727*^9, 3.720272708601898*^9, 3.720272758938056*^9, 
   3.720284729963998*^9, 3.72028548967353*^9, 3.7204500872663193`*^9, 
   3.7206135547662363`*^9, 3.7206174674453783`*^9, 3.720623647864197*^9, 
   3.720626067363929*^9, 3.720627246145269*^9, 3.720628999026421*^9, {
   3.720629413285655*^9, 3.720629432922505*^9}, 3.720629986187358*^9, 
   3.72063816299345*^9, 3.720638689354652*^9, 3.72068473824124*^9, 
   3.720706321877589*^9, 3.720706534109964*^9, 3.7207072932576933`*^9, 
   3.72078131454277*^9, 3.7210218535730133`*^9, {3.721021923406027*^9, 
   3.721021946713118*^9}, 3.721021984642311*^9, 3.721022027104381*^9, {
   3.721022118251049*^9, 3.721022149068006*^9}, 3.7210224661422873`*^9, 
   3.721022591874954*^9, 3.72102278790232*^9, 3.721022826824349*^9, 
   3.7210233281839027`*^9, 3.721023405568285*^9, 3.721023512958206*^9, 
   3.7210240341998463`*^9, {3.721025598114994*^9, 3.721025613417894*^9}, {
   3.721025665353561*^9, 3.721025683337763*^9}, 3.721025736966387*^9, 
   3.721025777127624*^9, 3.72102586334795*^9, 3.721025933148738*^9, 
   3.721026082839666*^9, 3.7210261627769947`*^9, 3.721026195031934*^9, 
   3.7210262255118513`*^9, 3.721026295374916*^9, 3.721026338828886*^9, 
   3.721026472571417*^9, 3.7210268284048347`*^9, 3.721026891091797*^9, {
   3.721027126565545*^9, 3.721027138604211*^9}, 3.721027254292433*^9, 
   3.721031517046961*^9, 3.7218491948596497`*^9, 3.721849952850563*^9, 
   3.721849991932398*^9, 3.7218502381415586`*^9, 3.72185082634151*^9, 
   3.721903835457176*^9, 3.721904619064303*^9, 3.7219912286814823`*^9, 
   3.721991990799852*^9, 3.746606108600906*^9, 3.7472956192036977`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prec", "=", "80"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ordAna", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"err", "=", 
   RowBox[{"10", "^", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "prec"}], "/", "2"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kmax", "=", "19"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nmax", "=", 
   RowBox[{"10", "^", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yIndMax", "=", "128"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"yIndTab", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"1", "/", "2"}], "+", "ii"}], ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "0", ",", "yIndMax"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"kInner", "=", 
       RowBox[{"Floor", "[", 
        RowBox[{"k", "/", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"kOuter", "=", 
       RowBox[{"Floor", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k", "-", "1"}], ")"}], "/", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"yInd", "=", 
           RowBox[{"yIndTab", "[", 
            RowBox[{"[", "mm", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"n", "=", 
           RowBox[{"nmax", "+", "yInd"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"h", "=", 
           RowBox[{"R", "/", 
            RowBox[{"(", 
             RowBox[{"n", "-", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"y", "=", 
           RowBox[{"yInd", "*", "h"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"fun", "=", 
           RowBox[{"Simplify", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"r", "-", "y"}], ")"}], "^", 
               RowBox[{"(", 
                RowBox[{"ii", "-", "1"}], ")"}]}], "*", 
              RowBox[{
               RowBox[{
                RowBox[{"y", "^", "2"}], "/", 
                RowBox[{"r", "^", "2"}]}], "/", 
               RowBox[{"Sqrt", "[", 
                RowBox[{
                 RowBox[{"r", "^", "2"}], "-", 
                 RowBox[{"y", "^", "2"}]}], "]"}]}]}], ",", 
             RowBox[{"Assumptions", "\[Rule]", 
              RowBox[{"r", ">=", "0"}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"funNoSqrtSing", "=", 
           RowBox[{"Simplify", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"r", "-", "y"}], ")"}], "^", 
               RowBox[{"(", 
                RowBox[{"ii", "-", "1"}], ")"}]}], "*", 
              RowBox[{
               RowBox[{
                RowBox[{"y", "^", "2"}], "/", 
                RowBox[{"r", "^", "2"}]}], "/", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"r", "+", "y"}], "]"}]}]}], ",", 
             RowBox[{"Assumptions", "\[Rule]", 
              RowBox[{"r", ">=", "0"}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"funNoSing", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"r", "-", "y"}], ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"ii", "-", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"yInd", "<", "40"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"b", "=", 
              RowBox[{"Table", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"intervals", "=", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"jj", "-", "1"}], ")"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"jj", ",", "1", ",", "nmax"}], "}"}]}], "]"}]}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"arr", "=", 
                  RowBox[{"ConstantArray", "[", 
                   RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{"0", ",", "prec"}], "]"}], ",", 
                    RowBox[{"2", "+", "ordAna"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"arr", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "=", 
                  RowBox[{"NIntegrate", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"fun", "/.", 
                    RowBox[{"r", "\[Rule]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"nInd", "+", "yInd"}], ")"}], "*", "h"}]}]}], 
                    ")"}], "-", 
                    RowBox[{"(", 
                    RowBox[{"fun", "/.", 
                    RowBox[{"r", "\[Rule]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ceiling", "[", "nInd", "]"}], "+", "yInd"}], 
                    ")"}], "*", "h"}]}]}], ")"}]}], ",", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", "nInd", "}"}], ",", "intervals"}], "]"}], 
                    ",", 
                    RowBox[{"PrecisionGoal", "\[Rule]", 
                    RowBox[{"prec", "/", "2"}]}], ",", 
                    RowBox[{"WorkingPrecision", "\[Rule]", "prec"}], ",", 
                    RowBox[{"MaxRecursion", "\[Rule]", "50"}], ",", 
                    RowBox[{"Method", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", 
                    RowBox[{"\"\<SymbolicProcessing\>\"", "\[Rule]", "0"}]}], 
                    "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"arr", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "=", 
                  RowBox[{"N", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "2"}], "*", "fun"}], "/.", 
                    RowBox[{"r", "\[Rule]", "R"}]}], ",", "prec"}], "]"}]}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"arr", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "=", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{"fun", ",", 
                    RowBox[{"{", 
                    RowBox[{"r", ",", "1"}], "}"}]}], "]"}], "*", 
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{"h", "*", 
                    RowBox[{
                    RowBox[{"BernoulliB", "[", "2", "]"}], "/", 
                    RowBox[{"Factorial", "[", "2", "]"}]}]}], ",", "prec"}], 
                    "]"}]}], "/.", 
                   RowBox[{"r", "\[Rule]", "R"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"For", "[", 
                  RowBox[{
                   RowBox[{"ll", "=", "2"}], ",", 
                   RowBox[{"ll", "\[LessEqual]", "ordAna"}], ",", 
                   RowBox[{"ll", "++"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", "+", "ll"}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{"fun", ",", 
                    RowBox[{"{", 
                    RowBox[{"r", ",", 
                    RowBox[{
                    RowBox[{"2", "*", "ll"}], "-", "1"}]}], "}"}]}], "]"}], 
                    "*", 
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"h", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "ll"}], "-", "1"}], ")"}]}], "*", 
                    RowBox[{
                    RowBox[{"BernoulliB", "[", 
                    RowBox[{"2", "*", "ll"}], "]"}], "/", 
                    RowBox[{"Factorial", "[", 
                    RowBox[{"2", "*", "ll"}], "]"}]}]}], ",", "prec"}], 
                    "]"}]}], "/.", 
                    RowBox[{"r", "\[Rule]", "R"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"sum", "=", 
                    RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", 
                    RowBox[{"2", "+", "ll"}]}], "]"}], "]"}], ",", 
                    RowBox[{
                    "Method", "\[Rule]", "\"\<CompensatedSummation\>\""}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ll", ">", 
                    RowBox[{"Floor", "[", 
                    RowBox[{"2", "+", 
                    RowBox[{"ii", "/", "2"}]}], "]"}]}], "&&", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", "+", "ll"}], "]"}], "]"}], "]"}], "<=", 
                    RowBox[{"err", "*", 
                    RowBox[{"Abs", "[", "sum", "]"}]}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Break", "[", "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ll", "\[GreaterEqual]", "ordAna"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "yInd", ",", 
                    "\"\<Euler-Mclaurin series possibly not converged.\>\""}],
                     "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                 "sum"}], ",", 
                RowBox[{"{", 
                 RowBox[{"ii", ",", "1", ",", "k"}], "}"}]}], "]"}]}], ";"}], 
            ",", "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"b", "=", 
              RowBox[{"Table", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"arr", "=", 
                  RowBox[{"ConstantArray", "[", 
                   RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{"0", ",", "prec"}], "]"}], ",", 
                    RowBox[{"ordAna", "+", "1"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"arr", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "=", 
                  RowBox[{
                   RowBox[{"funNoSqrtSing", "*", 
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Zeta", "[", 
                    RowBox[{"1", "/", "2"}], "]"}], "*", 
                    RowBox[{"h", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "2"}], ")"}]}]}], ",", "prec"}], 
                    "]"}]}], "/.", 
                   RowBox[{"r", "\[Rule]", "y"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"For", "[", 
                  RowBox[{
                   RowBox[{"ll", "=", "1"}], ",", 
                   RowBox[{"ll", "\[LessEqual]", "ordAna"}], ",", 
                   RowBox[{"ll", "++"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", "+", "ll"}], "]"}], "]"}], "=", 
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{"funNoSqrtSing", ",", 
                    RowBox[{"{", 
                    RowBox[{"r", ",", "ll"}], "}"}]}], "]"}], "*", 
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Zeta", "[", 
                    RowBox[{
                    RowBox[{"1", "/", "2"}], "-", "ll"}], "]"}], "*", 
                    RowBox[{
                    RowBox[{"h", "^", 
                    RowBox[{"(", 
                    RowBox[{"ll", "-", 
                    RowBox[{"1", "/", "2"}]}], ")"}]}], "/", 
                    RowBox[{"Factorial", "[", "ll", "]"}]}]}], ",", "prec"}], 
                    "]"}]}], "/.", 
                    RowBox[{"r", "\[Rule]", "y"}]}], ",", "prec"}], "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"sum", "=", 
                    RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", 
                    RowBox[{"1", "+", "ll"}]}], "]"}], "]"}], ",", 
                    RowBox[{
                    "Method", "\[Rule]", "\"\<CompensatedSummation\>\""}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ll", ">", 
                    RowBox[{"1", "+", "ii"}]}], "&&", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", "+", "ll"}], "]"}], "]"}], "]"}], "<=", 
                    RowBox[{"err", "*", 
                    RowBox[{"Abs", "[", "sum", "]"}]}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Break", "[", "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ll", "\[GreaterEqual]", "ordAna"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "yInd", ",", 
                    "\"\<Euler-Mclaurin series possibly not converged.\>\""}],
                     "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"-", "sum"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"ii", ",", "1", ",", "k"}], "}"}]}], "]"}]}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"A", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"funNoSing", "/.", 
              RowBox[{"r", "\[Rule]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"yInd", "+", "jj"}], ")"}], "*", "h"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"ii", ",", "1", ",", "k"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"jj", ",", 
               RowBox[{"-", "kOuter"}], ",", "kInner"}], "}"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{"LinearSolve", "[", 
             RowBox[{"A", ",", "b"}], "]"}], "*", "h"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"mm", ",", "1", ",", 
           RowBox[{"Length", "[", "yIndTab", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"StringJoin", "[", 
         RowBox[{
         "\"\<coeffs_invSqrtDiffSqY2OR2_sing_small_halfShift_\>\"", ",", 
          RowBox[{"IntegerString", "[", 
           RowBox[{"k", ",", "10", ",", "2"}], "]"}], ",", "\"\<.h5\>\""}], 
         "]"}], ",", "res"}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "kmax", ",", "1"}], "}"}]}], "]"}], ";"}], "//",
   "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.7202623576663837`*^9, 3.7202623624584713`*^9}, {
   3.720262413236515*^9, 3.720262414381234*^9}, {3.720262497536972*^9, 
   3.720262498248596*^9}, {3.72026253413792*^9, 3.72026253551213*^9}, {
   3.720262619420191*^9, 3.7202626245206013`*^9}, {3.720263079682765*^9, 
   3.7202630893481894`*^9}, {3.7202631542063828`*^9, 3.720263206764176*^9}, {
   3.7202632557456512`*^9, 3.72026339069245*^9}, {3.720263427376861*^9, 
   3.720263458308584*^9}, {3.720263612681045*^9, 3.720263633621195*^9}, {
   3.720263877477725*^9, 3.720263879357451*^9}, {3.720263957211768*^9, 
   3.720263961225602*^9}, {3.720271385699242*^9, 3.720271391155657*^9}, {
   3.72027145186655*^9, 3.720271495457625*^9}, {3.720271573739019*^9, 
   3.720271580046077*^9}, {3.720271683188286*^9, 3.720271685956151*^9}, {
   3.720271728442789*^9, 3.720271735174266*^9}, {3.720271845994583*^9, 
   3.72027184862389*^9}, {3.720271907551126*^9, 3.720271907912381*^9}, {
   3.7202841516084337`*^9, 3.720284181168743*^9}, {3.720284838076559*^9, 
   3.720284863666751*^9}, {3.720285026952745*^9, 3.720285027373744*^9}, {
   3.7202851241255913`*^9, 3.720285164002942*^9}, {3.720285246582374*^9, 
   3.720285252038666*^9}, {3.720285311429324*^9, 3.720285312782075*^9}, {
   3.720449002598144*^9, 3.7204490028756332`*^9}, {3.7206074206585703`*^9, 
   3.7206074221349773`*^9}, {3.720607799858944*^9, 3.720607814308754*^9}, {
   3.720617151842688*^9, 3.7206171800719643`*^9}, {3.720617226386244*^9, 
   3.720617227417454*^9}, {3.720621391224712*^9, 3.720621397449583*^9}, {
   3.72070673563756*^9, 3.720706769403591*^9}, {3.720712651658946*^9, 
   3.720712654051505*^9}, 3.720713979555107*^9, {3.720779367320842*^9, 
   3.72077936759571*^9}, {3.72093402437903*^9, 3.720934024396068*^9}, {
   3.720952976362496*^9, 3.7209529885453167`*^9}, 3.720954163636585*^9, 
   3.7210228096779833`*^9, {3.721030029212142*^9, 3.7210300302184143`*^9}, 
   3.721030091712016*^9, {3.7210308164420137`*^9, 3.7210308195858173`*^9}, {
   3.7210308563332243`*^9, 3.7210308662707663`*^9}, {3.721030897678342*^9, 
   3.721030899134757*^9}, {3.7218493167745113`*^9, 3.721849342302884*^9}, {
   3.72184998136486*^9, 3.721849981665633*^9}, {3.721850026115402*^9, 
   3.721850030834659*^9}, {3.721850097751977*^9, 3.721850108089068*^9}, {
   3.7218502544348097`*^9, 3.721850254612227*^9}, {3.721850405528253*^9, 
   3.7218504064484873`*^9}, {3.721852753874848*^9, 3.721852754899242*^9}, {
   3.721991386780819*^9, 3.721991403793858*^9}, {3.7465975642760935`*^9, 
   3.746597577668167*^9}, {3.746597650707136*^9, 3.7465976569712152`*^9}, 
   3.7466315195161967`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3119.4756884763`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.7202636776040382`*^9, 3.720263942120448*^9, 
  3.7202708213069973`*^9, 3.72028422289999*^9, 3.720285099440126*^9, 
  3.720285131903027*^9, 3.72028525707063*^9, 3.72028573202836*^9, 
  3.720451466960186*^9, 3.7206083505273323`*^9, 3.72061685690168*^9, 
  3.720618628021886*^9, 3.7207078000962276`*^9, 3.7207819718346033`*^9, 
  3.721031652702283*^9, 3.721851513262048*^9, 3.7218535009920053`*^9, 
  3.721992756545948*^9, 3.746608758784828*^9, 3.7472987386079607`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Large y", "Section",
 CellChangeTimes->{{3.721021258005183*^9, 3.7210212607651663`*^9}, {
  3.721021676601905*^9, 3.721021678528324*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"prec", "=", "80"}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"R", " ", "=", " ", "1"}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"nmax", " ", "=", " ", 
    RowBox[{"10", "^", "2"}]}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ordAna", " ", "=", " ", "100"}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"err", " ", "=", " ", 
    RowBox[{"10", "^", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "prec"}], "/", "2"}], ")"}]}]}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"kmax", " ", "=", " ", "19"}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"yCross", " ", "=", " ", "128"}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"yInvCount", " ", "=", " ", "256"}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"yInvTable", " ", "=", " ", 
    RowBox[{
     RowBox[{"Range", "[", "yInvCount", "]"}], "/", 
     RowBox[{"(", 
      RowBox[{"yInvCount", "*", "yCross"}], ")"}]}]}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"yIndTab", " ", "=", " ", 
    RowBox[{"1", "/", "yInvTable"}]}], ";"}], " ", 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"kInner", "=", 
       RowBox[{"Floor", "[", 
        RowBox[{"k", "/", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"kOuter", "=", 
       RowBox[{"Floor", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k", "-", "1"}], ")"}], "/", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fun", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x", "-", "1"}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"ii", "-", "1"}], ")"}]}], "/", 
        RowBox[{"Sqrt", "[", "x", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"funNoSing", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x", "-", "1"}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"ii", "-", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"10", "^", "3"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xmax", "=", 
       RowBox[{"N", "[", 
        RowBox[{"1", ",", "prec"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"h", "=", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"n", "-", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"b0", "=", 
       RowBox[{"-", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"funNoSing", ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "ss"}], "}"}]}], "]"}], "*", 
              RowBox[{"N", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Zeta", "[", 
                  RowBox[{
                   RowBox[{"1", "/", "2"}], "-", "ss"}], "]"}], "*", 
                 RowBox[{
                  RowBox[{"h", "^", 
                   RowBox[{"(", 
                    RowBox[{"ss", "-", 
                    RowBox[{"1", "/", "2"}]}], ")"}]}], "/", 
                  RowBox[{"Factorial", "[", "ss", "]"}]}]}], ",", "prec"}], 
               "]"}]}], "/.", 
             RowBox[{"x", "\[Rule]", "0"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"ss", ",", "0", ",", 
              RowBox[{"ii", "-", "1"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", "k"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"A0", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"N", "[", 
          RowBox[{
           RowBox[{"funNoSing", "/.", 
            RowBox[{"x", "\[Rule]", 
             RowBox[{"jj", "*", "h"}]}]}], ",", "prec"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "k"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", 
           RowBox[{"-", "kOuter"}], ",", "kInner"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"A0", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", ";;"}], "]"}], "]"}], "=", 
       RowBox[{"N", "[", 
        RowBox[{"1", ",", "prec"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"resSqrt", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"LinearSolve", "[", 
          RowBox[{"A0", ",", "b0"}], "]"}], "*", 
         RowBox[{"h", "^", 
          RowBox[{"(", 
           RowBox[{"1", "/", "2"}], ")"}]}]}], "//", "N"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"res", " ", "=", " ", 
       RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"yInd", " ", "=", " ", 
           RowBox[{"yIndTab", "[", 
            RowBox[{"[", "mm", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"n", " ", "=", " ", 
           RowBox[{"nmax", " ", "+", " ", "yInd"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"h", " ", "=", " ", 
           RowBox[{"R", "/", 
            RowBox[{"(", 
             RowBox[{"n", " ", "-", " ", "1"}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"y", " ", "=", " ", 
           RowBox[{"yInd", "*", "h"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"fun", " ", "=", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"r", " ", "-", " ", "y"}], ")"}], "^", 
              RowBox[{"(", 
               RowBox[{"ii", " ", "-", " ", "1"}], ")"}]}], ")"}], "*", 
            RowBox[{
             RowBox[{
              RowBox[{"y", "^", "2"}], "/", 
              RowBox[{"r", "^", "2"}]}], "/", 
             RowBox[{"Sqrt", "[", 
              RowBox[{
               RowBox[{"r", "^", "2"}], " ", "-", " ", 
               RowBox[{"y", "^", "2"}]}], "]"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"funNoSqrtSing", " ", "=", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"r", " ", "-", " ", "y"}], ")"}], "^", 
              RowBox[{"(", 
               RowBox[{"ii", " ", "-", " ", "1"}], ")"}]}], ")"}], "*", 
            RowBox[{
             RowBox[{
              RowBox[{"y", "^", "2"}], "/", 
              RowBox[{"r", "^", "2"}]}], "/", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"r", " ", "+", " ", "y"}], "]"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"funNoSing", " ", "=", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"r", " ", "-", " ", "y"}], ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"ii", " ", "-", " ", "1"}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"b", "=", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"arr", "=", 
               RowBox[{"ConstantArray", "[", 
                RowBox[{
                 RowBox[{"N", "[", 
                  RowBox[{"0", ",", "prec"}], "]"}], ",", 
                 RowBox[{"ordAna", "+", "1"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"arr", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{"funNoSqrtSing", "*", 
                 RowBox[{"N", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Zeta", "[", 
                    RowBox[{"1", "/", "2"}], "]"}], "*", 
                    RowBox[{"h", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "2"}], ")"}]}]}], ",", "prec"}], 
                  "]"}]}], "/.", 
                RowBox[{"r", "\[Rule]", "y"}]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"ll", "=", "1"}], ",", 
                RowBox[{"ll", "\[LessEqual]", "ordAna"}], ",", 
                RowBox[{"ll", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"arr", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", "+", "ll"}], "]"}], "]"}], "=", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{"funNoSqrtSing", ",", 
                    RowBox[{"{", 
                    RowBox[{"r", ",", "ll"}], "}"}]}], "]"}], "*", 
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Zeta", "[", 
                    RowBox[{
                    RowBox[{"1", "/", "2"}], "-", "ll"}], "]"}], "*", 
                    RowBox[{
                    RowBox[{"h", "^", 
                    RowBox[{"(", 
                    RowBox[{"ll", "-", 
                    RowBox[{"1", "/", "2"}]}], ")"}]}], "/", 
                    RowBox[{"Factorial", "[", "ll", "]"}]}]}], ",", "prec"}], 
                    "]"}]}], "/.", 
                   RowBox[{"r", "\[Rule]", "y"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"sum", "=", 
                  RowBox[{"Total", "[", 
                   RowBox[{
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", 
                    RowBox[{"1", "+", "ll"}]}], "]"}], "]"}], ",", 
                    RowBox[{
                    "Method", "\[Rule]", "\"\<CompensatedSummation\>\""}]}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"ll", ">", 
                    RowBox[{"1", "+", "ii"}]}], "&&", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"arr", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", "+", "ll"}], "]"}], "]"}], "]"}], "<=", 
                    RowBox[{"err", "*", 
                    RowBox[{"Abs", "[", "sum", "]"}]}]}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Break", "[", "]"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ll", "\[GreaterEqual]", "ordAna"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "Print", "[", 
                    "\"\<Euler-Mclaurin series possibly not converged.\>\"", 
                    "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"-", "sum"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"ii", ",", "1", ",", "k"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"A", " ", "=", " ", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"funNoSing", " ", "/.", " ", 
              RowBox[{"r", " ", "\[Rule]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"yInd", "+", " ", "jj"}], ")"}], "*", "h"}]}]}], ",",
              " ", 
             RowBox[{"{", 
              RowBox[{"ii", ",", " ", "1", ",", " ", "k"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"jj", ",", " ", 
               RowBox[{"-", "kOuter"}], ",", "kInner"}], "}"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{"LinearSolve", "[", 
             RowBox[{"A", ",", " ", "b"}], "]"}], "*", "h", "*", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"2", "*", "yInd"}], "]"}]}], "]"}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"mm", ",", " ", "1", ",", " ", 
           RowBox[{"Length", "[", "yIndTab", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "resSqrt", "}"}], ",", "res"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"StringJoin", "[", 
         RowBox[{"\"\<coeffs_invSqrtDiffSqY2OR2_sing_large_\>\"", ",", " ", 
          RowBox[{"IntegerString", "[", 
           RowBox[{"k", ",", " ", "10", ",", " ", "2"}], "]"}], ",", " ", 
          "\"\<.h5\>\""}], "]"}], ",", " ", "res"}], "]"}]}], 
     "\[IndentingNewLine]", ",", " ", 
     RowBox[{"{", 
      RowBox[{"k", ",", " ", "1", ",", "kmax", ",", " ", "1"}], "}"}]}], 
    "]"}], ";"}], " ", "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.721021295821636*^9, 3.721021316883609*^9}, {
   3.721021352062236*^9, 3.7210213908415737`*^9}, {3.721021445858818*^9, 
   3.721021539083493*^9}, {3.7210215756230507`*^9, 3.7210216354107637`*^9}, {
   3.7210312803233643`*^9, 3.721031323878023*^9}, {3.721850066084104*^9, 
   3.721850066437045*^9}, {3.721850415447418*^9, 3.721850422205206*^9}, {
   3.7218505915731983`*^9, 3.7218506123177834`*^9}, {3.7218536426226482`*^9, 
   3.721853643908917*^9}, {3.7219914127921753`*^9, 3.721991431954962*^9}, {
   3.7465975893711586`*^9, 3.7465976393147464`*^9}, 3.746609465382018*^9, 
   3.746611142041233*^9, 3.7466315195308323`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1419.125046911335`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.721031780540066*^9, 3.7218535043090143`*^9, 
  3.721854063894061*^9, 3.721993186791274*^9, 3.7466094321776743`*^9, 
  3.7466108703021965`*^9, 3.7473001577987113`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7466036477772584`*^9, 3.746603650017318*^9}}]
}, Closed]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Numerical derivative", "Chapter",
 CellChangeTimes->{{3.719321430172298*^9, 3.719321449788741*^9}, 
   3.719322026112195*^9, {3.720372642055887*^9, 3.720372644465417*^9}, {
   3.7204490672561493`*^9, 3.72044907563925*^9}, {3.7209340186001673`*^9, 
   3.720934018781063*^9}, {3.720935313896204*^9, 3.7209353183993196`*^9}, 
   3.746793808239376*^9, {3.746795192464986*^9, 3.7467951946289587`*^9}}],

Cell["\<\
Numerical derivative needed for the calculation calculation of the backward \
or inverse Abel transform. Basic central finite difference of arbitrary order \
accuracy. \
\>", "Text",
 CellChangeTimes->{{3.7472883740302734`*^9, 3.74728845546145*^9}}],

Cell[CellGroupData[{

Cell["Smooth Derivative", "Subchapter",
 CellChangeTimes->{{3.719324107054667*^9, 3.7193241078540897`*^9}, {
   3.72037266579218*^9, 3.720372668455263*^9}, 3.7209340188259993`*^9, 
   3.72093532230311*^9}],

Cell["Typical evaluation time: Milliseconds", "Text",
 CellChangeTimes->{{3.719322981985248*^9, 3.7193229975689497`*^9}, {
  3.7209340189419947`*^9, 3.720934019086828*^9}, {3.720935322875511*^9, 
  3.7209353237260447`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kmax", "=", "19"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prec", "=", "80"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"err", "=", 
    RowBox[{"10", "^", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "prec"}], "/", "2"}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"(", 
        RowBox[{"k", "+", "1"}], ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"s", "=", 
       RowBox[{"n", "/", "2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{
        RowBox[{"CoefficientList", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"Series", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"x", "^", "s"}], "*", 
              RowBox[{
               RowBox[{"Log", "[", "x", "]"}], "/", "h"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}], ",", 
          "x"}], "]"}], "//", "N"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"StringJoin", "[", 
         RowBox[{"\"\<coeffs_deriv_smooth_\>\"", ",", 
          RowBox[{"IntegerString", "[", 
           RowBox[{"n", ",", "10", ",", "2"}], "]"}], ",", "\"\<.h5\>\""}], 
         "]"}], ",", "res"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"Chop", "[", 
        RowBox[{"res", ",", "err"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
     ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "kmax", ",", "2"}], "}"}]}], "]"}], ";"}], "//",
   "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.719321767713479*^9, 3.719321794145452*^9}, {
   3.71932182975523*^9, 3.719321918149322*^9}, {3.719321951359614*^9, 
   3.719321984166931*^9}, {3.719322029561405*^9, 3.719322063338276*^9}, {
   3.7193222462973957`*^9, 3.719322306202744*^9}, {3.719322753475047*^9, 
   3.7193227567298117`*^9}, {3.719322817308003*^9, 3.719322953403296*^9}, {
   3.719739871303584*^9, 3.719739871367413*^9}, 3.720433962730173*^9, {
   3.7204340506314373`*^9, 3.7204340508067513`*^9}, {3.720434100209763*^9, 
   3.720434100425538*^9}, {3.720440011105669*^9, 3.720440011200992*^9}, {
   3.720779183565824*^9, 3.720779321256976*^9}, {3.7207794557555637`*^9, 
   3.720779455994529*^9}, {3.721458621161765*^9, 3.721458745448031*^9}, {
   3.721458777204102*^9, 3.721458777779316*^9}, {3.7466035255784082`*^9, 
   3.7466035256506042`*^9}, {3.746613551309054*^9, 3.746613563156225*^9}, 
   3.7467938731825542`*^9, {3.7467939793667817`*^9, 3.746793979406798*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.09956925507218584`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.721458734353923*^9, 3.7214587458686047`*^9}, 
   3.7214587789990892`*^9, 3.746611238936285*^9, 3.7466135596975975`*^9, 
   3.7467939339597497`*^9, 3.746793979998028*^9, 3.7467941726079473`*^9, {
   3.7467950837986135`*^9, 3.7467951059631214`*^9}, 3.7467951973792763`*^9, 
   3.747300157998724*^9}]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Open  ]]
},
WindowSize->{958, 988},
WindowMargins->{{Automatic, -7}, {Automatic, 0}},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 225, 3, 90, "Title"],
Cell[808, 27, 1462, 23, 182, "Text"],
Cell[CellGroupData[{
Cell[2295, 54, 205, 3, 64, "Chapter"],
Cell[CellGroupData[{
Cell[2525, 61, 503, 11, 50, "Input"],
Cell[3031, 74, 133, 2, 30, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[3213, 82, 528, 12, 75, "Chapter"],
Cell[3744, 96, 879, 13, 87, "Text"],
Cell[CellGroupData[{
Cell[4648, 113, 256, 4, 61, "Subchapter"],
Cell[CellGroupData[{
Cell[4929, 121, 174, 2, 63, "Section"],
Cell[5106, 125, 255, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[5386, 132, 12021, 254, 601, "Input"],
Cell[17410, 388, 1204, 18, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[18663, 412, 176, 2, 49, "Section"],
Cell[18842, 416, 240, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[19107, 424, 19291, 406, 1038, "Input"],
Cell[38401, 832, 813, 13, 70, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[39287, 853, 530, 14, 85, "Chapter"],
Cell[39820, 869, 362, 6, 49, "Text"],
Cell[CellGroupData[{
Cell[40207, 879, 198, 3, 61, "Subchapter"],
Cell[CellGroupData[{
Cell[40430, 886, 142, 2, 63, "Section"],
Cell[CellGroupData[{
Cell[40597, 892, 24777, 527, 1304, "Input"],
Cell[65377, 1421, 463, 8, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65877, 1434, 20097, 446, 1209, "Input"],
Cell[85977, 1882, 610, 10, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[86636, 1898, 203, 5, 49, "Section"],
Cell[86842, 1905, 219, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[87086, 1912, 16533, 382, 1076, "Input"],
Cell[103622, 2296, 253, 5, 70, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[103948, 2309, 430, 12, 85, "Chapter"],
Cell[104381, 2323, 208, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[104614, 2331, 174, 3, 61, "Subchapter"],
Cell[CellGroupData[{
Cell[104813, 2338, 118, 2, 63, "Section"],
Cell[CellGroupData[{
Cell[104956, 2344, 23472, 537, 1551, "Input"],
Cell[128431, 2883, 721, 12, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[129189, 2900, 18003, 418, 1266, "Input"],
Cell[147195, 3320, 368, 6, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[147612, 3332, 181, 5, 49, "Section"],
Cell[147796, 3339, 167, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[147988, 3345, 13221, 335, 1076, "Input"],
Cell[161212, 3682, 207, 4, 70, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[161492, 3694, 462, 15, 101, "Chapter"],
Cell[161957, 3711, 388, 6, 49, "Text"],
Cell[CellGroupData[{
Cell[162370, 3721, 99, 1, 61, "Subchapter"],
Cell[CellGroupData[{
Cell[162494, 3726, 145, 2, 63, "Section"],
Cell[CellGroupData[{
Cell[162664, 3732, 23961, 505, 1285, "Input"],
Cell[186628, 4239, 1757, 26, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[188422, 4270, 19830, 445, 1209, "Input"],
Cell[208255, 4717, 579, 9, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[208883, 4732, 143, 2, 49, "Section"],
Cell[CellGroupData[{
Cell[209051, 4738, 13791, 347, 1076, "Input"],
Cell[222845, 5087, 281, 5, 70, "Output"]
}, Open  ]],
Cell[223141, 5095, 94, 1, 30, "Input"]
}, Closed]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[223296, 5103, 402, 5, 53, "Chapter"],
Cell[223701, 5110, 259, 5, 49, "Text"],
Cell[CellGroupData[{
Cell[223985, 5119, 205, 3, 61, "Subchapter"],
Cell[224193, 5124, 223, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[224441, 5131, 2820, 65, 240, "Input"],
Cell[227264, 5198, 415, 7, 70, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Open  ]]
}
]
*)

